import React, { useState, useRef, useEffect, forwardRef, useCallback, useMemo } from "react";
import { App as CapacitorApp } from '@capacitor/app';
import { LocalNotifications } from '@capacitor/local-notifications';
import {
    Settings, Home, ArrowLeft, Clock, MapPin, Leaf, Activity, Landmark,
    ChevronRight, XCircle, Star, Heart, CheckCircle, Navigation, PlayCircle,
    Pause, Monitor, Award, Compass, LogOut, Info, Mail, Bell, Search, Send, Clapperboard,
    Sun, Moon, User, Map as MapIcon, Coffee, Waves, Trees, Mountain,
    Music, Camera, BookOpen, Smile, Bike, Globe, Building, Download, Loader
} from "lucide-react";

//
// 1. –°–¢–ò–õ–ò –ò –ù–ê–°–¢–†–û–ô–ö–ò (Styles & Config)
//

const THEME = {
    light: {
        bg: '#F3F4F6',
        surface: '#FFFFFF',
        text: '#1F2937',
        textMuted: '#6B7280',
        primary: '#10B981',
        border: '#E5E7EB',
        cardShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03)',
    },
    dark: {
        bg: '#111827',
        surface: '#1F2937',
        text: '#F9FAFB',
        textMuted: '#9CA3AF',
        primary: '#34D399',
        border: '#374151',
        cardShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.25), 0 2px 4px -1px rgba(0, 0, 0, 0.2)',
    }
};

const S = {
    flex: { display: 'flex' },
    itemsCenter: { alignItems: 'center' },
    justifyContent: { justifyContent: 'space-between' },
    justifyCenter: { justifyContent: 'center' },
    textCenter: { textAlign: 'center' },
    wFull: { width: '100%' },
    p4: { padding: '1rem' },
    p6: { padding: '1.5rem' },
    py3: { paddingTop: '0.875rem', paddingBottom: '0.875rem' },
    px6: { paddingLeft: '1.5rem', paddingRight: '1.5rem' },
    roundedXl: { borderRadius: '1rem' },
    rounded2xl: { borderRadius: '1.5rem' },
    roundedFull: { borderRadius: '9999px' },
    fontSemibold: { fontWeight: 600 },
    fontBold: { fontWeight: 800 },
    textLg: { fontSize: '1.125rem' },
    textXl: { fontSize: '1.25rem', lineHeight: '1.75rem' },
    emerald600: '#059669',
    emerald700: '#047857',
    sky600: '#0284c7',
    red500: '#ef4444',
    orange500: '#f97316',
    dark: {
        bg: THEME.dark.bg,
        text: THEME.dark.text,
        cardBg: THEME.dark.surface,
        cardBorder: THEME.dark.border,
        textMuted: THEME.dark.textMuted,
        buttonBg: THEME.dark.primary,
        shadow: THEME.dark.cardShadow
    },
    light: {
        bg: THEME.light.bg,
        text: THEME.light.text,
        cardBg: THEME.light.surface,
        cardBorder: THEME.light.border,
        textMuted: THEME.light.textMuted,
        buttonBg: THEME.light.primary,
        shadow: THEME.light.cardShadow
    }
};

const cardStyle = {
    padding: '1rem',
    borderRadius: '1.25rem',
    border: '1px solid',
    cursor: 'pointer',
    width: '100%',
    textAlign: 'left',
    overflow: 'hidden',
    transform: 'translateZ(0)',
    boxSizing: 'border-box',
    transition: 'transform 0.1s ease-in-out, box-shadow 0.2s ease',
    position: 'relative'
};

// --- –§–£–ù–ö–¶–ò–Ø –ü–û–õ–£–ß–ï–ù–ò–Ø –°–¢–ò–õ–ï–ô –ö–ê–¢–ï–ì–û–†–ò–ô (–ò–ö–û–ù–ö–ò) ---
// --- –§–£–ù–ö–¶–ò–Ø –ü–û–õ–£–ß–ï–ù–ò–Ø –°–¢–ò–õ–ï–ô –ö–ê–¢–ï–ì–û–†–ò–ô (–ò–ö–û–ù–ö–ò) ---
const getCategoryStyle = (subCategoryName) => {
    // 1. –î–µ—Ñ–æ–ª—Ç–Ω—ã–π —Å—Ç–∏–ª—å (–µ—Å–ª–∏ –∏–∫–æ–Ω–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞)
    const defaultStyle = {
        iconComp: <MapPin size={20} color="#6B7280" />,
        svgString: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#6B7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>'
    };

    // 2. –•–µ–ª–ø–µ—Ä –¥–ª—è SVG (–¥–ª—è –º–∞—Ä–∫–µ—Ä–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ)
    const createSvg = (color, path) => `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${color}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">${path}</svg>`;

    // 3. –°–õ–û–í–ê–†–¨ –°–¢–ò–õ–ï–ô (–í—Å–µ 34 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ CATALOG_STRUCTURE)
    const styles = {
        // === –ö–£–õ–¨–¢–£–†–ù–´–ï –ò –ò–°–¢–û–†–ò–ß–ï–°–ö–ò–ï ===
        "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è": {
            iconComp: <Waves size={20} color="#3b82f6" />,
            svgString: createSvg('#3b82f6', '<path d="M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/><path d="M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/><path d="M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/>')
        },
        "–ú—É–∑–µ–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∏": {
            iconComp: <Landmark size={20} color="#a855f7" />,
            svgString: createSvg('#a855f7', '<line x1="3" y1="22" x2="21" y2="22"/><line x1="6" y1="18" x2="6" y2="11"/><line x1="10" y1="18" x2="10" y2="11"/><line x1="14" y1="18" x2="14" y2="11"/><line x1="18" y1="18" x2="18" y2="11"/><polygon points="12 2 20 7 4 7"/>')
        },
        "–ü–∞–º—è—Ç–Ω–∏–∫–∏ –∏ –º–µ–º–æ—Ä–∏–∞–ª—ã": {
            iconComp: <Award size={20} color="#ef4444" />,
            svgString: createSvg('#ef4444', '<circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/>')
        },
        "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏": {
            iconComp: <Building size={20} color="#f97316" />,
            svgString: createSvg('#f97316', '<rect x="4" y="2" width="16" height="20" rx="2" ry="2"/><line x1="9" y1="22" x2="9" y2="22"/><line x1="15" y1="22" x2="15" y2="22"/>')
        },
        "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∏": {
            iconComp: <MapIcon size={20} color="#ef4444" />,
            svgString: createSvg('#ef4444', '<polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/>')
        },
        "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∫–≤–∞—Ä—Ç–∞–ª—ã": {
            iconComp: <Building size={20} color="#92400e" />,
            svgString: createSvg('#92400e', '<rect x="4" y="2" width="16" height="20" rx="2" ry="2"/><path d="M9 22v-4h6v4"/><path d="M8 6h.01"/><path d="M16 6h.01"/><path d="M8 10h.01"/><path d="M16 10h.01"/><path d="M8 14h.01"/><path d="M16 14h.01"/>')
        },
        "–¶–µ—Ä–∫–≤–∏ –∏ —Ö—Ä–∞–º—ã": {
            iconComp: <Sun size={20} color="#eab308" />,
            svgString: createSvg('#eab308', '<circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>')
        },
        "–õ–µ–≥–µ–Ω–¥—ã –∏ –º–∏—Ñ—ã –≥–æ—Ä–æ–¥–∞": {
            iconComp: <BookOpen size={20} color="#8b5cf6" />,
            svgString: createSvg('#8b5cf6', '<path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>')
        },

        // === –ü–†–ò–†–û–î–ù–´–ï –ò –ê–ö–¢–ò–í–ù–´–ï ===
        "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏": {
            iconComp: <Trees size={20} color="#16a34a" />,
            svgString: createSvg('#16a34a', '<path d="M10 10v.2A3 3 0 0 1 8.9 16v0H5v0h0a3 3 0 0 1-1-5.8V10a3 3 0 0 1 6 0Z"/><path d="M7 16v6"/><path d="M13 19v3"/><path d="M12 19h8.3a1 1 0 0 0 .7-1.7L18 14h.3a1 1 0 0 0 .7-1.7L16 9h.2a1 1 0 0 0 .6-1.7L13 3l-1.4 1.5"/>')
        },
        "–ì–æ—Ä–Ω—ã–µ –∏ –ª–µ—Å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": {
            iconComp: <Mountain size={20} color="#15803d" />,
            svgString: createSvg('#15803d', '<path d="m8 3 4 8 5-5 5 15H2L8 3z"/><path d="M4.14 15.08c2.62-1.57 5.24-1.43 7.86.42 2.74 1.94 5.49 2 8.23.19"/>')
        },
        "–ê–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö —É –≤–æ–¥—ã": {
            iconComp: <Waves size={20} color="#0ea5e9" />,
            svgString: createSvg('#0ea5e9', '<path d="M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/><path d="M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/><path d="M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/>')
        },
        "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∫–∏ –∏ —Ñ–∏—Ç–Ω–µ—Å-–ø–∞—Ä–∫–∏": {
            iconComp: <Activity size={20} color="#dc2626" />,
            svgString: createSvg('#dc2626', '<polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>')
        },

        // === –°–û–í–†–ï–ú–ï–ù–ù–´–ï –ò –£–†–ë–ê–ù–ò–°–¢–ò–ß–ï–°–ö–ò–ï ===
        "–°–∫—É–ª—å–ø—Ç—É—Ä—ã –∏ —É–ª–∏—á–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ": {
            iconComp: <Smile size={20} color="#f59e0b" />,
            svgString: createSvg('#f59e0b', '<circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/>')
        },
        "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞": {
            iconComp: <Building size={20} color="#60a5fa" />,
            svgString: createSvg('#60a5fa', '<rect x="4" y="2" width="16" height="20" rx="2" ry="2"/><path d="M9 22v-4h6v4"/><path d="M8 6h.01"/><path d="M16 6h.01"/><path d="M8 10h.01"/><path d="M16 10h.01"/><path d="M8 14h.01"/><path d="M16 14h.01"/>')
        },
        "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏": {
            iconComp: <Monitor size={20} color="#6b7280" />,
            svgString: createSvg('#6b7280', '<rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/>')
        },
        "–†–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è": {
            iconComp: <Settings size={20} color="#9ca3af" />,
            svgString: createSvg('#9ca3af', '<circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>')
        },

        // === –ì–ê–°–¢–†–û–ù–û–ú–ò–ß–ï–°–ö–ò–ï ===
        "–ö–æ—Ñ–µ": {
            iconComp: <Coffee size={20} color="#854d0e" />,
            svgString: createSvg('#854d0e', '<path d="M17 8h1a4 4 0 1 1 0 8h-1"/><path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/>')
        },
        "–£–ª–∏—á–Ω–∞—è –µ–¥–∞": {
            iconComp: <Coffee size={20} color="#d97706" />,
            svgString: createSvg('#d97706', '<path d="M17 8h1a4 4 0 1 1 0 8h-1"/><path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/>')
        },
        "–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã": {
            iconComp: <Coffee size={20} color="#dc2626" />,
            svgString: createSvg('#dc2626', '<path d="M17 8h1a4 4 0 1 1 0 8h-1"/><path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/>')
        },
        "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã": {
            iconComp: <Star size={20} color="#eab308" />,
            svgString: createSvg('#eab308', '<polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>')
        },

        // === –°–ï–ú–ï–ô–ù–´–ï ===
        "–ü–∞—Ä–∫–∏ –∞—Ç—Ç—Ä–∞–∫—Ü–∏–æ–Ω—ã –∏ –¥–µ—Ç—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∫–∏": {
            iconComp: <Smile size={20} color="#ec4899" />,
            svgString: createSvg('#ec4899', '<circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/>')
        },
        "–ó–æ–æ–ø–∞—Ä–∫–∏": {
            iconComp: <Leaf size={20} color="#15803d" />,
            svgString: createSvg('#15803d', '<path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z"/><path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"/>')
        },
        "–ú—É–∑–µ–∏ –¥–ª—è –¥–µ—Ç–µ–π": {
            iconComp: <Smile size={20} color="#3b82f6" />,
            svgString: createSvg('#3b82f6', '<circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/>')
        },
        "–ü–∏–∫–Ω–∏–∫–∏ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ": {
            iconComp: <Sun size={20} color="#f59e0b" />,
            svgString: createSvg('#f59e0b', '<circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/>')
        },
        "–ò–≥—Ä–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –∑–æ–Ω—ã": {
            iconComp: <Clapperboard size={20} color="#8b5cf6" />,
            svgString: createSvg('#8b5cf6', '<rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"/><line x1="7" y1="2" x2="7" y2="22"/><line x1="17" y1="2" x2="17" y2="22"/><line x1="2" y1="12" x2="22" y2="12"/><line x1="2" y1="7" x2="7" y2="7"/><line x1="2" y1="17" x2="7" y2="17"/><line x1="17" y1="17" x2="22" y2="17"/><line x1="17" y1="7" x2="22" y2="7"/>')
        },

        // === –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–´–ï ===
        "–ó–∞–±—Ä–æ—à–µ–Ω–Ω—ã–µ –∑–¥–∞–Ω–∏—è –∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏": {
            iconComp: <Building size={20} color="#9ca3af" />,
            svgString: createSvg('#9ca3af', '<rect x="4" y="2" width="16" height="20" rx="2" ry="2"/>')
        },
        "–£—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è": {
            iconComp: <Search size={20} color="#4b5563" />,
            svgString: createSvg('#4b5563', '<circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>')
        },
        "–¢–∞–π–Ω—ã–µ –∏ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": {
            iconComp: <Compass size={20} color="#6366f1" />,
            svgString: createSvg('#6366f1', '<circle cx="12" cy="12" r="10"/><polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"/>')
        },
        "–ù–æ—á–Ω—ã–µ —ç–∫—Å–∫—É—Ä—Å–∏–∏": {
            iconComp: <Moon size={20} color="#7c3aed" />,
            svgString: createSvg('#7c3aed', '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>')
        },

        // === –¢–ï–ú–ê–¢–ò–ß–ï–°–ö–ò–ï ===
        "–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": {
            iconComp: <Music size={20} color="#ec4899" />,
            svgString: createSvg('#ec4899', '<path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/>')
        },
        "–ö–∏–Ω–æ –∏ —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ": {
            iconComp: <Clapperboard size={20} color="#ef4444" />,
            svgString: createSvg('#ef4444', '<rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"/><line x1="7" y1="2" x2="7" y2="22"/><line x1="17" y1="2" x2="17" y2="22"/><line x1="2" y1="12" x2="22" y2="12"/><line x1="2" y1="7" x2="7" y2="7"/><line x1="2" y1="17" x2="7" y2="17"/><line x1="17" y1="17" x2="22" y2="17"/><line x1="17" y1="7" x2="22" y2="7"/>')
        },
        "–ú–∏—Ñ—ã –∏ –ª–µ–≥–µ–Ω–¥—ã": { // –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –Ω–æ –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –∫–ª—é—á–∞ (–±–µ–∑ "–≥–æ—Ä–æ–¥–∞")
            iconComp: <BookOpen size={20} color="#8b5cf6" />,
            svgString: createSvg('#8b5cf6', '<path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>')
        },
        "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": {
            iconComp: <Monitor size={20} color="#6b7280" />,
            svgString: createSvg('#6b7280', '<rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/>')
        },
        "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": {
            iconComp: <Bike size={20} color="#f59e0b" />,
            svgString: createSvg('#f59e0b', '<circle cx="18.5" cy="17.5" r="3.5"/><circle cx="5.5" cy="17.5" r="3.5"/><circle cx="15" cy="5" r="1"/>')
        }
    };

    return styles[subCategoryName] || defaultStyle;
};

//
// 2. –î–ê–ù–ù–´–ï –õ–û–ö–ê–õ–ò–ó–ê–¶–ò–ò –ò –ì–û–†–û–î–û–í
//

const LANGUAGES = [
    { code: 'ru', label: '–†—É—Å—Å–∫–∏–π', icon: 'üá∑üá∫' },
    { code: 'de', label: 'Deutsch', icon: 'üá©üá™' },
    { code: 'hy', label: '’Ä’°’µ’•÷Ä’•’∂', icon: 'üá¶üá≤' },
    { code: 'en', label: 'English', icon: 'üá¨üáß' },
    { code: 'hi', label: '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä', icon: 'üáÆüá≥' },
];

const CITIES = [
    { id: 'kemerovo', lat: 55.3533, lon: 86.0883 },
    { id: 'moscow', lat: 55.7558, lon: 37.6173 },
    { id: 'yerevan', lat: 40.1872, lon: 44.5152 },
    { id: 'dusseldorf', lat: 51.2277, lon: 6.7735 },
    { id: 'arambol', lat: 15.6861, lon: 73.7144 },
];

const TRANSLATIONS = {
    ru: {
        app_name: "–Ø –°–ê–ú",
        rec: "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏", cat: "–ö–∞—Ç–∞–ª–æ–≥", search: "–ü–æ–∏—Å–∫", fav: "–ò–∑–±—Ä–∞–Ω–Ω–æ–µ", map: "–ö–∞—Ä—Ç–∞",
        settings: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏", city: "–í—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞", lang: "–Ø–∑—ã–∫", close: "–ó–∞–∫—Ä—ã—Ç—å",
        completed: "–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ", account: "–ê–∫–∫–∞—É–Ω—Ç", contact: "–°–≤—è–∑–∞—Ç—å—Å—è", notif: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è",
        theme_light: "–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞", theme_dark: "–¢—ë–º–Ω–∞—è —Ç–µ–º–∞", exit: "–í—ã—Ö–æ–¥",
        search_ph: "–ü–æ–∏—Å–∫ –º–∞—Ä—à—Ä—É—Ç–æ–≤...", nothing: "–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ",
        steps: "—à–∞–≥–æ–≤", dist: "–∫–º", min: "–º–∏–Ω", audio: "–ê—É–¥–∏–æ", video: "–í–∏–¥–µ–æ",
        map_btn: "–ö–∞—Ä—Ç–∞", about: "–û –º–µ—Å—Ç–µ", to_fav: "–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ", visited: "–ü–æ—Å–µ—â–µ–Ω–æ",
        profile: "–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å", save: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å", cancel: "–û—Ç–º–µ–Ω–∞", change_photo: "–ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ç–æ",
        routes_done: "–ú–∞—Ä—à—Ä—É—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ", rewards: "–ù–∞–≥—Ä–∞–¥ –ø–æ–ª—É—á–µ–Ω–æ",
        new: "–ù–æ–≤–æ–µ", ads: "–†–µ–∫–ª–∞–º–∞", near: "–†—è–¥–æ–º —Å –≤–∞–º–∏", empty_list: "–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç",
        download: "–°–∫–∞—á–∞—Ç—å",
        audio_error: "–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è.",
        notif_permission_title: "–†–∞–∑—Ä–µ—à–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è",
        notif_permission_text: "–ú—ã –±—É–¥–µ–º —É–≤–µ–¥–æ–º–ª—è—Ç—å –≤–∞—Å –æ:\n‚Ä¢ –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–∞—Ö –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏\n‚Ä¢ –ù–æ–≤—ã—Ö –∞—É–¥–∏–æ–≥–∏–¥–∞—Ö\n‚Ä¢ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è\n\n–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–∏—á–µ–≥–æ –≤–∞–∂–Ω–æ–≥–æ!",
        notif_allow: "–†–∞–∑—Ä–µ—à–∏—Ç—å",
        notif_later: "–ü–æ–∑–∂–µ",
        city_kemerovo: "–ö–µ–º–µ—Ä–æ–≤–æ", city_moscow: "–ú–æ—Å–∫–≤–∞", city_yerevan: "–ï—Ä–µ–≤–∞–Ω", city_dusseldorf: "–î—é—Å—Å–µ–ª—å–¥–æ—Ä—Ñ", city_arambol: "–ê—Ä–∞–º–±–æ–ª—å",

        "–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ",
        "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ",
        "–°–µ–º–µ–π–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "–°–µ–º–µ–π–Ω—ã–µ",
        "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ",
        "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ",
        "–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ",
        "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Ä–±–∞–Ω",

        "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è": "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è", "–ú—É–∑–µ–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∏": "–ú—É–∑–µ–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∏", "–ü–∞–º—è—Ç–Ω–∏–∫–∏ –∏ –º–µ–º–æ—Ä–∏–∞–ª—ã": "–ü–∞–º—è—Ç–Ω–∏–∫–∏",
        "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏": "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞", "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∏": "–ü–ª–æ—â–∞–¥–∏",
        "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∫–≤–∞—Ä—Ç–∞–ª—ã": "–ö–≤–∞—Ä—Ç–∞–ª—ã", "–¶–µ—Ä–∫–≤–∏ –∏ —Ö—Ä–∞–º—ã": "–•—Ä–∞–º—ã", "–õ–µ–≥–µ–Ω–¥—ã –∏ –º–∏—Ñ—ã –≥–æ—Ä–æ–¥–∞": "–õ–µ–≥–µ–Ω–¥—ã –∏ –º–∏—Ñ—ã",

        "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏": "–ü–∞—Ä–∫–∏", "–ì–æ—Ä–Ω—ã–µ –∏ –ª–µ—Å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "–ì–æ—Ä—ã –∏ –ª–µ—Å",
        "–ê–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö —É –≤–æ–¥—ã": "–û—Ç–¥—ã—Ö —É –≤–æ–¥—ã", "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∫–∏ –∏ —Ñ–∏—Ç–Ω–µ—Å-–ø–∞—Ä–∫–∏": "–°–ø–æ—Ä—Ç –∏ —Ñ–∏—Ç–Ω–µ—Å",

        "–°–∫—É–ª—å–ø—Ç—É—Ä—ã –∏ —É–ª–∏—á–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ": "–°–∫—É–ª—å–ø—Ç—É—Ä—ã –∏ —Å—Ç—Ä–∏—Ç-–∞—Ä—Ç", "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞": "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞",
        "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏": "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏", "–†–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è": "–†–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏",

        "–ö–æ—Ñ–µ": "–ö–æ—Ñ–µ", "–£–ª–∏—á–Ω–∞—è –µ–¥–∞": "–£–ª–∏—á–Ω–∞—è –µ–¥–∞", "–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã": "–†–µ—Å—Ç–æ—Ä–∞–Ω—ã",
        "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã": "–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã",

        "–ü–∞—Ä–∫–∏ –∞—Ç—Ç—Ä–∞–∫—Ü–∏–æ–Ω—ã –∏ –¥–µ—Ç—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∫–∏": "–ê—Ç—Ç—Ä–∞–∫—Ü–∏–æ–Ω—ã", "–ó–æ–æ–ø–∞—Ä–∫–∏": "–ó–æ–æ–ø–∞—Ä–∫–∏",
        "–ú—É–∑–µ–∏ –¥–ª—è –¥–µ—Ç–µ–π": "–î–µ—Ç—Å–∫–∏–µ –º—É–∑–µ–∏", "–ü–∏–∫–Ω–∏–∫–∏ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ": "–ü–∏–∫–Ω–∏–∫–∏",
        "–ò–≥—Ä–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –∑–æ–Ω—ã": "–ò–≥—Ä–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã",

        "–ó–∞–±—Ä–æ—à–µ–Ω–Ω—ã–µ –∑–¥–∞–Ω–∏—è –∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏": "–ó–∞–±—Ä–æ—à–µ–Ω–Ω—ã–µ –º–µ—Å—Ç–∞", "–£—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è": "–£—Ä–±–∞–Ω–∏—Å—Ç–∏–∫–∞",
        "–¢–∞–π–Ω—ã–µ –∏ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "–¢–∞–π–Ω—ã –∏ –º–∏—Å—Ç–∏–∫–∞", "–ù–æ—á–Ω—ã–µ —ç–∫—Å–∫—É—Ä—Å–∏–∏": "–ù–æ—á–Ω—ã–µ —ç–∫—Å–∫—É—Ä—Å–∏–∏",

        "–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ", "–ö–∏–Ω–æ –∏ —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ": "–ö–∏–Ω–æ –∏ –¢–í",
        "–ú–∏—Ñ—ã –∏ –ª–µ–≥–µ–Ω–¥—ã": "–ú–∏—Ñ—ã –∏ –ª–µ–≥–µ–Ω–¥—ã", "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
        "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ",

        // –ú–∞—Ä—à—Ä—É—Ç—ã
        "Arambol Beach": "–ü–ª—è–∂ –ê—Ä–∞–º–±–æ–ª—å", "Best beach in North Goa": "–õ—É—á—à–∏–π –ø–ª—è–∂ —Å–µ–≤–µ—Ä–Ω–æ–≥–æ –ì–û–ê", "Medium": "–°—Ä–µ–¥–Ω—è—è",
        "Baba Tree": "–ë–æ–ª—å—à–æ–µ –±–∞–Ω—å—è–Ω–æ–≤–æ–µ –¥–µ—Ä–µ–≤–æ –∏ –ø—Ä–æ—Å–≤—è—â–µ–Ω–Ω—ã–π –ë–∞–±–∞", "Baba Description": "–ú–µ—Å—Ç–æ —Å–∏–ª—ã –∏ –º–µ–¥–∏—Ç–∞—Ü–∏–∏, –≥–¥–µ –ø–æ–¥ –æ–≥—Ä–æ–º–Ω—ã–º –±–∞–Ω—å—è–Ω–æ–º –æ–±–∏—Ç–∞–µ—Ç –ë–∞–±–∞.", "High": "–í—ã—Å–æ–∫–∞—è",
        "Arambol Rocks": "–°–∫–∞–ª–∞ –ê—Ä–∞–º–±–æ–ª—å", "Rocks Description": "–õ—É—á—à–∞—è –ª–æ–∫–∞—Ü–∏—è –¥–ª—è –∑–∞–∫–∞—Ç–∞ —Å –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–º –≤–∏–¥–æ–º –Ω–∞ –æ–∫–µ–∞–Ω.",
        "Red Square": "–ö—Ä–∞—Å–Ω–∞—è –ü–ª–æ—â–∞–¥—å", "Zaryadye": "–ü–∞—Ä–∫ –ó–∞—Ä—è–¥—å–µ", "Cascade": "–ö–∞—Å–∫–∞–¥", "Rheinturm": "–†–µ–π–Ω—Å–∫–∞—è –±–∞—à–Ω—è"
    },
    en: {
        app_name: "I MYSELF",
        rec: "Recommendations", cat: "Catalog", search: "Search", fav: "Favorites", map: "Map",
        settings: "Settings", city: "Select City", lang: "Language", close: "Close",
        completed: "Completed", account: "Account", contact: "Contact", notif: "Notifications",
        theme_light: "Light Theme", theme_dark: "Dark Theme", exit: "Exit",
        search_ph: "Search routes...", nothing: "Nothing found",
        steps: "steps", dist: "km", min: "min", audio: "Audio", video: "Video",
        map_btn: "Map", about: "About", to_fav: "Favorite", visited: "Visited",
        profile: "Your Profile", save: "Save", cancel: "Cancel", change_photo: "Change Photo",
        routes_done: "Routes completed", rewards: "Rewards earned",
        new: "New", near: "Near you", empty_list: "List is empty",
        download: "Download",
        audio_error: "Playback error.",
        notif_permission_title: "Enable Notifications",
        notif_permission_text: "We'll notify you about:\n‚Ä¢ Nearby routes\n‚Ä¢ New audio guides\n‚Ä¢ App updates\n\nDon't miss anything important!",
        notif_allow: "Allow",
        notif_later: "Later",
    
        city_kemerovo: "Kemerovo", city_moscow: "Moscow", city_yerevan: "Yerevan", city_dusseldorf: "Dusseldorf", city_arambol: "Arambol",

        "–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Cultural & Historical",
        "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Nature & Active",
        "–°–µ–º–µ–π–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Family Routes",
        "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Alternative",
        "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Gastronomic",
        "–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Thematic",
        "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Modern & Urban",

        "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è": "Embankment", "–ú—É–∑–µ–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∏": "Museums", "–ü–∞–º—è—Ç–Ω–∏–∫–∏ –∏ –º–µ–º–æ—Ä–∏–∞–ª—ã": "Monuments",
        "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏": "Architecture", "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∏": "Squares",
        "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∫–≤–∞—Ä—Ç–∞–ª—ã": "Historic Quarters", "–¶–µ—Ä–∫–≤–∏ –∏ —Ö—Ä–∞–º—ã": "Churches", "–õ–µ–≥–µ–Ω–¥—ã –∏ –º–∏—Ñ—ã –≥–æ—Ä–æ–¥–∞": "Myths & Legends",

        "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏": "Parks", "–ì–æ—Ä–Ω—ã–µ –∏ –ª–µ—Å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Forest Trails",
        "–ê–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö —É –≤–æ–¥—ã": "Water Activities", "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∫–∏ –∏ —Ñ–∏—Ç–Ω–µ—Å-–ø–∞—Ä–∫–∏": "Sports & Fitness",

        "–°–∫—É–ª—å–ø—Ç—É—Ä—ã –∏ —É–ª–∏—á–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ": "Street Art", "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞": "Modern Architecture",
        "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏": "Urban Labs", "–†–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è": "Restoration",

        "–ö–æ—Ñ–µ": "Coffee", "–£–ª–∏—á–Ω–∞—è –µ–¥–∞": "Street Food", "–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã": "Restaurants",
        "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã": "Master Classes",

        "–ü–∞—Ä–∫–∏ –∞—Ç—Ç—Ä–∞–∫—Ü–∏–æ–Ω—ã –∏ –¥–µ—Ç—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∫–∏": "Amusement Parks", "–ó–æ–æ–ø–∞—Ä–∫–∏": "Zoos",
        "–ú—É–∑–µ–∏ –¥–ª—è –¥–µ—Ç–µ–π": "Kids Museums", "–ü–∏–∫–Ω–∏–∫–∏ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ": "Picnics",
        "–ò–≥—Ä–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –∑–æ–Ω—ã": "Game Centers",

        "–ó–∞–±—Ä–æ—à–µ–Ω–Ω—ã–µ –∑–¥–∞–Ω–∏—è –∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏": "Abandoned Places", "–£—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è": "Urban Research",
        "–¢–∞–π–Ω—ã–µ –∏ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Secret & Mystic", "–ù–æ—á–Ω—ã–µ —ç–∫—Å–∫—É—Ä—Å–∏–∏": "Night Tours",

        "–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Musical", "–ö–∏–Ω–æ –∏ —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ": "Cinema & TV",
        "–ú–∏—Ñ—ã –∏ –ª–µ–≥–µ–Ω–¥—ã": "Myths & Legends", "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Tech & Innovation",
        "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Sports Routes",

        "Arambol Beach": "Arambol Beach", "Best beach in North Goa": "The best beach in North Goa", "Medium": "Medium",
        "Baba Tree": "The Big Banyan Tree and the Enlightened Baba", "Baba Description": "A place of power and meditation where Baba lives under a huge banyan tree.", "High": "High",
        "Arambol Rocks": "Arambol Rocks", "Rocks Description": "The best location for sunset with a stunning view of the ocean.",
        "Red Square": "Red Square", "Zaryadye": "Zaryadye Park", "Cascade": "The Cascade", "Rheinturm": "Rhine Tower"
    },
    de: {
        app_name: "ICH SELBST",
        rec: "Empfehlungen", cat: "Katalog", search: "Suche", fav: "Favoriten", map: "Karte",
        settings: "Einstellungen", city: "Stadt w√§hlen", lang: "Sprache", close: "Schlie√üen",
        completed: "Abgeschlossen", account: "Konto", contact: "Kontakt", notif: "Benachrichtigungen",
        theme_light: "Helles Thema", theme_dark: "Dunkles Thema", exit: "Ausgang",
        search_ph: "Routen suchen...", nothing: "Nichts gefunden",
        steps: "schritte", dist: "km", min: "min", audio: "Audio", video: "Video",
        map_btn: "Karte", about: "√úber", to_fav: "Favorit", visited: "Besucht",
        profile: "Ihr Profil", save: "Speichern", cancel: "Abbrechen", change_photo: "Foto √§ndern",
        routes_done: "Routen fertig", rewards: "Belohnungen",
        new: "Neu", near: "In der N√§he", empty_list: "Liste ist leer",
        download: "Herunterladen",
        audio_error: "Wiedergabefehler.",
        notif_permission_title: "Benachrichtigungen aktivieren",
        notif_permission_text: "Wir benachrichtigen Sie √ºber:\n‚Ä¢ Routen in der N√§he\n‚Ä¢ Neue Audioguides\n‚Ä¢ App-Updates\n\nVerpassen Sie nichts Wichtiges!",
        notif_allow: "Erlauben",
        notif_later: "Sp√§ter",
        city_kemerovo: "Kemerowo", city_moscow: "Moskau", city_yerevan: "Eriwan", city_dusseldorf: "D√ºsseldorf", city_arambol: "Arambol",

        "–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Kultur & Geschichte",
        "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Natur & Aktiv",
        "–°–µ–º–µ–π–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Familienrouten",
        "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Alternativ",
        "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Gastronomie",
        "–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Thematisch",
        "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Modern & Urban",

        "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è": "Uferpromenade", "–ú—É–∑–µ–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∏": "Museen", "–ü–∞–º—è—Ç–Ω–∏–∫–∏ –∏ –º–µ–º–æ—Ä–∏–∞–ª—ã": "Denkm√§ler",
        "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏": "Parks", "–ö–æ—Ñ–µ": "Kaffee",
        "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏": "Architektur", "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∏": "Pl√§tze",
        "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∫–≤–∞—Ä—Ç–∞–ª—ã": "Altstadt", "–¶–µ—Ä–∫–≤–∏ –∏ —Ö—Ä–∞–º—ã": "Kirchen", "–õ–µ–≥–µ–Ω–¥—ã –∏ –º–∏—Ñ—ã –≥–æ—Ä–æ–¥–∞": "Mythen & Legenden",
        
        "–ì–æ—Ä–Ω—ã–µ –∏ –ª–µ—Å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Waldwege", "–ê–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö —É –≤–æ–¥—ã": "Wassersport", "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∫–∏ –∏ —Ñ–∏—Ç–Ω–µ—Å-–ø–∞—Ä–∫–∏": "Sport & Fitness",
        "–°–∫—É–ª—å–ø—Ç—É—Ä—ã –∏ —É–ª–∏—á–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ": "Stra√üenkunst", "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞": "Moderne Architektur",
        "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏": "Stadtlabore", "–†–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è": "Restaurierung",
        "–£–ª–∏—á–Ω–∞—è –µ–¥–∞": "Street Food", "–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã": "Restaurants", "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã": "Meisterklassen",
        "–ü–∞—Ä–∫–∏ –∞—Ç—Ç—Ä–∞–∫—Ü–∏–æ–Ω—ã –∏ –¥–µ—Ç—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∫–∏": "Vergn√ºgungsparks", "–ó–æ–æ–ø–∞—Ä–∫–∏": "Zoos", "–ú—É–∑–µ–∏ –¥–ª—è –¥–µ—Ç–µ–π": "Kindermuseen",
        "–ü–∏–∫–Ω–∏–∫–∏ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ": "Picknicks", "–ò–≥—Ä–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –∑–æ–Ω—ã": "Spielzentren",
        "–ó–∞–±—Ä–æ—à–µ–Ω–Ω—ã–µ –∑–¥–∞–Ω–∏—è –∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏": "Verlassene Orte", "–£—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è": "Stadtforschung",
        "–¢–∞–π–Ω—ã–µ –∏ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Geheimnisvoll", "–ù–æ—á–Ω—ã–µ —ç–∫—Å–∫—É—Ä—Å–∏–∏": "Nachttouren",
        "–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Musik", "–ö–∏–Ω–æ –∏ —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ": "Kino & TV", "–ú–∏—Ñ—ã –∏ –ª–µ–≥–µ–Ω–¥—ã": "Mythen",
        "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Technik", "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "Sportrouten",

        "Arambol Beach": "Arambol Strand", "Best beach in North Goa": "Der beste Strand in Nord-Goa", "Medium": "Mittel",
        "Baba Tree": "Der gro√üe Banyan-Baum", "Baba Description": "Ein Ort der Kraft und Meditation.", "High": "Hoch",
        "Arambol Rocks": "Arambol Rocks", "Rocks Description": "Der beste Ort f√ºr den Sonnenuntergang.",
        "Red Square": "Roter Platz", "Zaryadye": "Zaryadye Park", "Cascade": "Kaskade", "Rheinturm": "Rheinturm"
    },
    hy: {
        app_name: "‘µ’ç ‘ª’Ü’î’ç",
        rec: "‘±’º’°’ª’°÷Ä’Ø’∂’•÷Ä", cat: "‘ø’°’ø’°’¨’∏’£", search: "’à÷Ä’∏’∂’•’¨", fav: "‘∏’∂’ø÷Ä’µ’°’¨’∂’•÷Ä", map: "’î’°÷Ä’ø’•’¶",
        settings: "‘ø’°÷Ä’£’°’æ’∏÷Ä’∏÷Ç’¥’∂’•÷Ä", city: "‘∏’∂’ø÷Ä’•’¨ ÷Ñ’°’≤’°÷Ñ", lang: "‘º’•’¶’∏÷Ç", close: "’ì’°’Ø’•’¨",
        completed: "‘±’æ’°÷Ä’ø’æ’°’Æ", account: "’Ä’°’∑’´’æ", contact: "‘ø’°’∫", notif: "‘æ’°’∂’∏÷Ç÷Å’∏÷Ç’¥’∂’•÷Ä",
        theme_light: "‘º’∏÷Ç’Ω’°’æ’∏÷Ä ’©’•’¥’°", theme_dark: "’Ñ’∏÷Ç’© ’©’•’¥’°", exit: "‘µ’¨÷Ñ",
        search_ph: "’à÷Ä’∏’∂’•’¨ ’•÷Ä’©’∏÷Ç’≤’´’∂’•÷Ä...", nothing: "’à’π’´’∂’π ’π’´ ’£’ø’∂’æ’•’¨",
        steps: "÷Ñ’°’µ’¨", dist: "’Ø’¥", min: "÷Ä’∏’∫’•", audio: "‘±’∏÷Ç’§’´’∏", video: "’é’´’§’•’∏",
        map_btn: "’î’°÷Ä’ø’•’¶", about: "’Ñ’°’Ω’´’∂", to_fav: "’Ä’°’æ’°’∂’•’¨", visited: "‘±’µ÷Å’•’¨’°’Æ",
        profile: "’Å’•÷Ä ’ß’ª’®", save: "’ä’°’∞’∫’°’∂’•’¨", cancel: "’â’•’≤’°÷Ä’Ø’•’¨", change_photo: "’ì’∏’≠’•’¨ ’∂’Ø’°÷Ä’®",
        routes_done: "‘±’∂÷Å’°’Æ ’•÷Ä’©’∏÷Ç’≤’´’∂’•÷Ä", rewards: "’ä’°÷Ä’£÷á’∂’•÷Ä",
        new: "’Ü’∏÷Ä", near: "’Ñ’∏’ø’°’Ø’°’µ÷Ñ’∏÷Ç’¥", empty_list: "’ë’∏÷Ç÷Å’°’Ø’® ’§’°’ø’°÷Ä’Ø ’ß",
        download: "’Ü’•÷Ä’¢’•’º’∂’•’¨",
        audio_error: "’ç’≠’°’¨:",
        notif_permission_title: "‘π’∏÷Ç’µ’¨ ’ø’æ’•÷Ñ ’Æ’°’∂’∏÷Ç÷Å’∏÷Ç’¥’∂’•÷Ä’®",
        notif_permission_text: "’Ñ’•’∂÷Ñ ’Ø’Æ’°’∂’∏÷Ç÷Å’•’∂÷Ñ ’±’•’¶’ù\n‚Ä¢ ’Ñ’∏’ø’°’Ø’° ’•÷Ä’©’∏÷Ç’≤’´’∂’•÷Ä’´ ’¥’°’Ω’´’∂\n‚Ä¢ ’Ü’∏÷Ä ’°’∏÷Ç’§’´’∏’∏÷Ç’≤’•÷Å’∏÷Ç’µ÷Å’∂’•÷Ä’´\n‚Ä¢ ‘π’°÷Ä’¥’°÷Å’∏÷Ç’¥’∂’•÷Ä’´\n\n’Ñ’´’õ ’¢’°÷Å ’©’∏’≤’•÷Ñ ’Ø’°÷Ä÷á’∏÷Ä’®!",
        notif_allow: "‘π’∏÷Ç’µ’¨’°’ø÷Ä’•’¨",
        notif_later: "‘±’æ’•’¨’´ ’∏÷Ç’∑",
        city_kemerovo: "‘ø’•’¥’•÷Ä’∏’æ’∏", city_moscow: "’Ñ’∏’Ω’Ø’æ’°", city_yerevan: "‘µ÷Ä÷á’°’∂", city_dusseldorf: "‘¥’µ’∏÷Ç’Ω’•’¨’§’∏÷Ä÷Ü", city_arambol: "‘±÷Ä’°’¥’¢’∏’¨",

        "–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "’Ñ’∑’°’Ø’∏÷Ç’©’°’µ’´’∂",
        "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‘≤’∂’∏÷Ç’©’µ’∏÷Ç’∂",
        "–°–µ–º–µ–π–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‘∏’∂’ø’°’∂’•’Ø’°’∂",
        "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‘±’µ’¨’®’∂’ø÷Ä’°’∂÷Ñ’°’µ’´’∂",
        "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‘≥’°’Ω’ø÷Ä’∏’∂’∏’¥’´’°’Ø’°’∂",
        "–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‘π’•’¥’°’ø’´’Ø",
        "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‘∫’°’¥’°’∂’°’Ø’°’Ø’´÷Å",

        "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è": "‘±÷É’°’¥’•÷Ä’±", "–ú—É–∑–µ–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∏": "‘π’°’∂’£’°÷Ä’°’∂’∂’•÷Ä", "–ü–∞–º—è—Ç–Ω–∏–∫–∏ –∏ –º–µ–º–æ—Ä–∏–∞–ª—ã": "’Ä’∏÷Ç’∑’°÷Ä’±’°’∂’∂’•÷Ä", "–ö–æ—Ñ–µ": "’ç’∏÷Ç÷Ä’≥",
        "–°–∫—É–ª—å–ø—Ç—É—Ä—ã –∏ —É–ª–∏—á–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ": "’ì’∏’≤’∏÷Å’°’µ’´’∂ ’°÷Ä’æ’•’Ω’ø", "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏": "‘±’µ’£’´’∂’•÷Ä", "–¶–µ—Ä–∫–≤–∏ –∏ —Ö—Ä–∞–º—ã": "‘µ’Ø’•’≤’•÷Å’´’∂’•÷Ä",
        "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏": "’É’°÷Ä’ø’°÷Ä’°’∫’•’ø’∏÷Ç’©’µ’∏÷Ç’∂", "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∏": "’Ä÷Ä’°’∫’°÷Ä’°’Ø’∂’•÷Ä",
        "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∫–≤–∞—Ä—Ç–∞–ª—ã": "’ä’°’ø’¥’°’Ø’°’∂ ’©’°’≤’°’¥’°’Ω’•÷Ä", "–õ–µ–≥–µ–Ω–¥—ã –∏ –º–∏—Ñ—ã –≥–æ—Ä–æ–¥–∞": "‘º’•’£’•’∂’§’∂’•÷Ä",
        "–ì–æ—Ä–Ω—ã–µ –∏ –ª–µ—Å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‘±’∂’ø’°’º’°’µ’´’∂", "–ê–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö —É –≤–æ–¥—ã": "’ã÷Ä’°’µ’´’∂ ’∞’°’∂’£’´’Ω’ø", "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∫–∏ –∏ —Ñ–∏—Ç–Ω–µ—Å-–ø–∞—Ä–∫–∏": "’ç’∫’∏÷Ä’ø",
        "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞": "‘∫’°’¥’°’∂’°’Ø’°’Ø’´÷Å ’≥’°÷Ä’ø’°÷Ä’°’∫’•’ø’∏÷Ç’©’µ’∏÷Ç’∂", "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏": "’î’°’≤’°÷Ñ’°’µ’´’∂ ’¨’°’¢’∏÷Ä’°’ø’∏÷Ä’´’°’∂’•÷Ä",
        "–†–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è": "’é’•÷Ä’°’Ø’°’∂’£’∂’∏÷Ç’¥", "–£–ª–∏—á–Ω–∞—è –µ–¥–∞": "’ì’∏’≤’∏÷Å’°’µ’´’∂ ’Ω’∂’∏÷Ç’∂’§", "–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã": "’å’•’Ω’ø’∏÷Ä’°’∂’∂’•÷Ä",
        "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã": "’é’°÷Ä’∫’•’ø’∏÷Ç’©’µ’°’∂ ’§’°’Ω’•÷Ä", "–ü–∞—Ä–∫–∏ –∞—Ç—Ç—Ä–∞–∫—Ü–∏–æ–Ω—ã –∏ –¥–µ—Ç—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∫–∏": "‘±’ø÷Ä’°’Ø÷Å’´’∏’∂’∂’•÷Ä",
        "–ó–æ–æ–ø–∞—Ä–∫–∏": "‘ø’•’∂’§’°’∂’°’¢’°’∂’°’Ø’°’∂ ’°’µ’£’´’∂’•÷Ä", "–ú—É–∑–µ–∏ –¥–ª—è –¥–µ—Ç–µ–π": "’Ñ’°’∂’Ø’°’Ø’°’∂ ’©’°’∂’£’°÷Ä’°’∂’∂’•÷Ä", "–ü–∏–∫–Ω–∏–∫–∏ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ": "’ä’´’Ø’∂’´’Ø’∂’•÷Ä",
        "–ò–≥—Ä–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –∑–æ–Ω—ã": "‘Ω’°’≤’°’µ’´’∂ ’Ø’•’∂’ø÷Ä’∏’∂’∂’•÷Ä", "–ó–∞–±—Ä–æ—à–µ–Ω–Ω—ã–µ –∑–¥–∞–Ω–∏—è –∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏": "‘º÷Ñ’æ’°’Æ ’æ’°’µ÷Ä’•÷Ä",
        "–£—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è": "’à÷Ç÷Ä’¢’°’∂’´’Ω’ø’´’Ø’°", "–¢–∞–π–Ω—ã–µ –∏ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‘≥’°’≤’ø’∂’´ ÷á ’¥’´’Ω’ø’´’Ø",
        "–ù–æ—á–Ω—ã–µ —ç–∫—Å–∫—É—Ä—Å–∏–∏": "‘≥’´’∑’•÷Ä’°’µ’´’∂ ’ß÷Ñ’Ω’Ø’∏÷Ç÷Ä’Ω’´’°’∂’•÷Ä", "–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‘µ÷Ä’°’™’∑’ø’°’Ø’°’∂", "–ö–∏–Ω–æ –∏ —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ": "‘ø’´’∂’∏ ÷á TV",
        "–ú–∏—Ñ—ã –∏ –ª–µ–≥–µ–Ω–¥—ã": "‘±’º’°’Ω’∫’•’¨’∂’•÷Ä", "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "’è’•’≠’∂’∏’¨’∏’£’´’°’∂’•÷Ä", "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "’ç’∫’∏÷Ä’ø’°’µ’´’∂",

        "Arambol Beach": "‘±÷Ä’°’¥’¢’∏’¨ ’¨’∏’≤’°÷É", "Best beach in North Goa": "’Ä’µ’∏÷Ç’Ω’´’Ω’°’µ’´’∂ ‘≥’∏’°’´ ’¨’°’æ’°’£’∏÷Ç’µ’∂ ’¨’∏’≤’°÷É’®", "Medium": "’Ñ’´’ª’´’∂",
        "Baba Tree": "’Ñ’•’Æ ’¢’°’∂’µ’°’∂ ’Æ’°’º’®", "Baba Description": "‘∂’∏÷Ä’∏÷Ç’©’µ’°’∂ ÷á ’¥’•’§’´’ø’°÷Å’´’°’µ’´ ’æ’°’µ÷Ä:", "High": "‘≤’°÷Ä’±÷Ä",
        "Arambol Rocks": "‘±÷Ä’°’¥’¢’∏’¨ ’™’°’µ’º’•÷Ä", "Rocks Description": "‘º’°’æ’°’£’∏÷Ç’µ’∂ ’æ’°’µ÷Ä’® ’¥’°’µ÷Ä’°’¥’∏÷Ç’ø’´ ’∞’°’¥’°÷Ä:",
        "Red Square": "‘ø’°÷Ä’¥’´÷Ä ’∞÷Ä’°’∫’°÷Ä’°’Ø", "Zaryadye": "‘∂’°÷Ä’µ’°’§’´’•", "Cascade": "‘ø’°’Ω’Ø’°’§", "Rheinturm": "’Ä’º’•’∂’∏’Ω’´ ’°’∑’ø’°÷Ä’°’Ø"
    },
    hi: {
        app_name: "‡§Æ‡•à‡§Ç ‡§∏‡•ç‡§µ‡§Ø‡§Ç",
        rec: "‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•á‡§Ç", cat: "‡§∏‡•Ç‡§ö‡•Ä", search: "‡§ñ‡•ã‡§ú‡•á‡§Ç", fav: "‡§™‡§∏‡§Ç‡§¶‡•Ä‡§¶‡§æ", map: "‡§Æ‡§æ‡§®‡§ö‡§ø‡§§‡•ç‡§∞",
        settings: "‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏", city: "‡§∂‡§π‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç", lang: "‡§≠‡§æ‡§∑‡§æ", close: "‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç",
        completed: "‡§™‡•Ç‡§∞‡•ç‡§£", account: "‡§ñ‡§æ‡§§‡§æ", contact: "‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï", notif: "‡§∏‡•Ç‡§ö‡§®‡§æ‡§è‡§Ç",
        theme_light: "‡§≤‡§æ‡§á‡§ü ‡§•‡•Ä‡§Æ", theme_dark: "‡§°‡§æ‡§∞‡•ç‡§ï ‡§•‡•Ä‡§Æ", exit: "‡§®‡§ø‡§ï‡§æ‡§∏",
        search_ph: "‡§Æ‡§æ‡§∞‡•ç‡§ó ‡§ñ‡•ã‡§ú‡•á‡§Ç...", nothing: "‡§ï‡•Å‡§õ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ",
        steps: "‡§ï‡§¶‡§Æ", dist: "‡§ï‡§ø‡§Æ‡•Ä", min: "‡§Æ‡§ø‡§®‡§ü", audio: "‡§ë‡§°‡§ø‡§Ø‡•ã", video: "‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã",
        map_btn: "‡§Æ‡§æ‡§®‡§ö‡§ø‡§§‡•ç‡§∞", about: "‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç", to_fav: "‡§™‡§∏‡§Ç‡§¶‡•Ä‡§¶‡§æ ‡§Æ‡•á‡§Ç", visited: "‡§¶‡•á‡§ñ‡§æ ‡§ó‡§Ø‡§æ",
        profile: "‡§Ü‡§™‡§ï‡•Ä ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤", save: "‡§∏‡§π‡•á‡§ú‡•á‡§Ç", cancel: "‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç", change_photo: "‡§´‡•ã‡§ü‡•ã ‡§¨‡§¶‡§≤‡•á‡§Ç",
        routes_done: "‡§Æ‡§æ‡§∞‡•ç‡§ó ‡§™‡•Ç‡§∞‡•á ‡§π‡•Å‡§è", rewards: "‡§™‡•Å‡§∞‡§∏‡•ç‡§ï‡§æ‡§∞",
        new: "‡§®‡§Ø‡§æ", near: "‡§Ü‡§™‡§ï‡•á ‡§™‡§æ‡§∏", empty_list: "‡§∏‡•Ç‡§ö‡•Ä ‡§ñ‡§æ‡§≤‡•Ä ‡§π‡•à",
        download: "‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç",
        audio_error: "‡§ë‡§°‡§ø‡§Ø‡•ã ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡•§",
        notif_permission_title: "‡§∏‡•Ç‡§ö‡§®‡§æ‡§è‡§Ç ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡•á‡§Ç",
        notif_permission_text: "‡§π‡§Æ ‡§Ü‡§™‡§ï‡•ã ‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á:\n‚Ä¢ ‡§™‡§æ‡§∏ ‡§ï‡•á ‡§Æ‡§æ‡§∞‡•ç‡§ó‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç\n‚Ä¢ ‡§®‡§è ‡§ë‡§°‡§ø‡§Ø‡•ã ‡§ó‡§æ‡§á‡§°\n‚Ä¢ ‡§ê‡§™ ‡§Ö‡§™‡§°‡•á‡§ü\n\n‡§ï‡•Å‡§õ ‡§≠‡•Ä ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§® ‡§ö‡•Ç‡§ï‡•á‡§Ç!",
        notif_allow: "‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§Ç",
        notif_later: "‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç",
        city_kemerovo: "‡§ï‡•á‡§Æ‡•á‡§∞‡•ã‡§µ‡•ã", city_moscow: "‡§Æ‡§æ‡§∏‡•ç‡§ï‡•ã", city_yerevan: "‡§Ø‡•á‡§∞‡•á‡§µ‡§æ‡§®", city_dusseldorf: "‡§°‡§∏‡•á‡§≤‡§°‡•ã‡§∞‡•ç‡§´", city_arambol: "‡§Ö‡§∞‡§Æ‡•ç‡§¨‡•ã‡§≤",
        
        "–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‡§∏‡§æ‡§Ç‡§∏‡•ç‡§ï‡•É‡§§‡§ø‡§ï",
        "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‡§™‡•ç‡§∞‡§ï‡•É‡§§‡§ø",
        "–°–µ–º–µ–π–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‡§™‡§æ‡§∞‡§ø‡§µ‡§æ‡§∞‡§ø‡§ï",
        "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï",
        "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‡§ñ‡§æ‡§®-‡§™‡§æ‡§®",
        "–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‡§µ‡§ø‡§∑‡§Ø‡§ó‡§§",
        "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‡§Ü‡§ß‡•Å‡§®‡§ø‡§ï",

        "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è": "‡§§‡§ü‡§¨‡§Ç‡§ß", "–ú—É–∑–µ–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∏": "‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡§æ‡§≤‡§Ø", "–ü–∞–º—è—Ç–Ω–∏–∫–∏ –∏ –º–µ–º–æ—Ä–∏–∞–ª—ã": "‡§∏‡•ç‡§Æ‡§æ‡§∞‡§ï", "–ö–æ—Ñ–µ": "‡§ï‡•â‡§´‡§º‡•Ä",
        "–°–∫—É–ª—å–ø—Ç—É—Ä—ã –∏ —É–ª–∏—á–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ": "‡§∏‡§°‡§º‡§ï ‡§ï‡§≤‡§æ", "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏": "‡§™‡§æ‡§∞‡•ç‡§ï", "–¶–µ—Ä–∫–≤–∏ –∏ —Ö—Ä–∞–º—ã": "‡§Æ‡§Ç‡§¶‡§ø‡§∞",
        "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏": "‡§µ‡§æ‡§∏‡•ç‡§§‡•Å‡§ï‡§≤‡§æ", "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∏": "‡§ö‡•å‡§ï", "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∫–≤–∞—Ä—Ç–∞–ª—ã": "‡§ê‡§§‡§ø‡§π‡§æ‡§∏‡§ø‡§ï",
        "–õ–µ–≥–µ–Ω–¥—ã –∏ –º–∏—Ñ—ã –≥–æ—Ä–æ–¥–∞": "‡§Æ‡§ø‡§•‡§ï", "–ì–æ—Ä–Ω—ã–µ –∏ –ª–µ—Å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‡§µ‡§® ‡§Æ‡§æ‡§∞‡•ç‡§ó", "–ê–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö —É –≤–æ–¥—ã": "‡§ú‡§≤ ‡§ó‡§§‡§ø‡§µ‡§ø‡§ß‡§ø‡§Ø‡§æ‡§Å",
        "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∫–∏ –∏ —Ñ–∏—Ç–Ω–µ—Å-–ø–∞—Ä–∫–∏": "‡§ñ‡•á‡§≤", "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞": "‡§Ü‡§ß‡•Å‡§®‡§ø‡§ï ‡§µ‡§æ‡§∏‡•ç‡§§‡•Å‡§ï‡§≤‡§æ", "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏": "‡§∂‡§π‡§∞‡•Ä ‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó‡§∂‡§æ‡§≤‡§æ‡§è‡§Ç",
        "–†–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è": "‡§ú‡•Ä‡§∞‡•ç‡§£‡•ã‡§¶‡•ç‡§ß‡§æ‡§∞", "–£–ª–∏—á–Ω–∞—è –µ–¥–∞": "‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§ü ‡§´‡•Ç‡§°", "–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã": "‡§∞‡•á‡§∏‡•ç‡§§‡§∞‡§æ‡§Ç",
        "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã": "‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•ç‡§≤‡§æ‡§∏", "–ü–∞—Ä–∫–∏ –∞—Ç—Ç—Ä–∞–∫—Ü–∏–æ–Ω—ã –∏ –¥–µ—Ç—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∫–∏": "‡§Æ‡§®‡•ã‡§∞‡§Ç‡§ú‡§® ‡§™‡§æ‡§∞‡•ç‡§ï",
        "–ó–æ–æ–ø–∞—Ä–∫–∏": "‡§ö‡§ø‡§°‡§º‡§ø‡§Ø‡§æ‡§ò‡§∞", "–ú—É–∑–µ–∏ –¥–ª—è –¥–µ—Ç–µ–π": "‡§¨‡§ö‡•ç‡§ö‡•ã‡§Ç ‡§ï‡§æ ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡§æ‡§≤‡§Ø", "–ü–∏–∫–Ω–∏–∫–∏ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ": "‡§™‡§ø‡§ï‡§®‡§ø‡§ï",
        "–ò–≥—Ä–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –∑–æ–Ω—ã": "‡§ó‡•á‡§Æ ‡§∏‡•á‡§Ç‡§ü‡§∞", "–ó–∞–±—Ä–æ—à–µ–Ω–Ω—ã–µ –∑–¥–∞–Ω–∏—è –∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏": "‡§™‡§∞‡§ø‡§§‡•ç‡§Ø‡§ï‡•ç‡§§ ‡§∏‡•ç‡§•‡§æ‡§®",
        "–£—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è": "‡§∂‡§π‡§∞‡•Ä ‡§Ö‡§®‡•Å‡§∏‡§Ç‡§ß‡§æ‡§®", "–¢–∞–π–Ω—ã–µ –∏ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‡§∞‡§π‡§∏‡•ç‡§Ø‡§Æ‡§Ø", "–ù–æ—á–Ω—ã–µ —ç–∫—Å–∫—É—Ä—Å–∏–∏": "‡§∞‡§æ‡§§‡•ç‡§∞‡§ø ‡§≠‡•ç‡§∞‡§Æ‡§£",
        "–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‡§∏‡§Ç‡§ó‡•Ä‡§§", "–ö–∏–Ω–æ –∏ —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ": "‡§∏‡§ø‡§®‡•á‡§Æ‡§æ", "–ú–∏—Ñ—ã –∏ –ª–µ–≥–µ–Ω–¥—ã": "‡§Æ‡§ø‡§•‡§ï ‡§î‡§∞ ‡§ï‡§ø‡§Ç‡§µ‡§¶‡§Ç‡§§‡§ø‡§Ø‡§æ‡§Ç",
        "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‡§§‡§ï‡§®‡•Ä‡§ï‡•Ä", "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": "‡§ñ‡•á‡§≤ ‡§Æ‡§æ‡§∞‡•ç‡§ó",

        "Arambol Beach": "‡§Ö‡§∞‡§Æ‡•ç‡§¨‡•ã‡§≤ ‡§¨‡•Ä‡§ö", "Best beach in North Goa": "‡§â‡§§‡•ç‡§§‡§∞‡•Ä ‡§ó‡•ã‡§µ‡§æ ‡§ï‡§æ ‡§∏‡§¨‡§∏‡•á ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§∏‡§Æ‡•Å‡§¶‡•ç‡§∞ ‡§§‡§ü", "Medium": "‡§Æ‡§ß‡•ç‡§Ø‡§Æ",
        "Baba Tree": "‡§¨‡§°‡§º‡§æ ‡§¨‡§∞‡§ó‡§¶ ‡§ï‡§æ ‡§™‡•á‡§°‡§º", "Baba Description": "‡§∂‡§ï‡•ç‡§§‡§ø ‡§î‡§∞ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§ï‡§æ ‡§∏‡•ç‡§•‡§æ‡§®‡•§", "High": "‡§â‡§ö‡•ç‡§ö",
        "Arambol Rocks": "‡§Ö‡§∞‡§Æ‡•ç‡§¨‡•ã‡§≤ ‡§ö‡§ü‡•ç‡§ü‡§æ‡§®‡•á‡§Ç", "Rocks Description": "‡§∏‡•Ç‡§∞‡•ç‡§Ø‡§æ‡§∏‡•ç‡§§ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§¨‡§∏‡•á ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§ú‡§ó‡§π‡•§",
        "Red Square": "‡§≤‡§æ‡§≤ ‡§ö‡•å‡§ï", "Zaryadye": "‡§ú‡§º‡§æ‡§∞‡•ç‡§Ø‡§æ‡§¶‡•ç‡§Ø‡•á", "Cascade": "‡§ï‡•à‡§∏‡•ç‡§ï‡•á‡§°", "Rheinturm": "‡§∞‡§æ‡§á‡§® ‡§ü‡•â‡§µ‡§∞"
    }
};

const calculateDistance = (lat1, lon1, lat2, lon2) => {
    if (!lat1 || !lon1 || !lat2 || !lon2) return 0;
    const R = 6371; const dLat = (lat2 - lat1) * Math.PI / 180; const dLon = (lon2 - lon1) * Math.PI / 180; const a = Math.sin(dLat / 2) ** 2 + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon / 2) ** 2; const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a)); return R * c;
};
const isCategoryActive = (categoryData) => {
    if (!categoryData) return false;
    return Object.values(categoryData).some(subCategoryArray => Array.isArray(subCategoryArray) && subCategoryArray.length > 0);
};

const RUSTORE_LINK = "https://www.rustore.ru/catalog/app/com.yasam.app";
const VERSION_CHECK_URL = "https://archive.org/download/version_20260220/version.json";

const CATALOG_STRUCTURE = {
    "–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": ["–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è", "–ú—É–∑–µ–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∏", "–ü–∞–º—è—Ç–Ω–∏–∫–∏ –∏ –º–µ–º–æ—Ä–∏–∞–ª—ã", "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏", "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∏", "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∫–≤–∞—Ä—Ç–∞–ª—ã", "–¶–µ—Ä–∫–≤–∏ –∏ —Ö—Ä–∞–º—ã", "–õ–µ–≥–µ–Ω–¥—ã –∏ –º–∏—Ñ—ã –≥–æ—Ä–æ–¥–∞"],
    "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": ["–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏", "–ì–æ—Ä–Ω—ã–µ –∏ –ª–µ—Å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã", "–ê–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö —É –≤–æ–¥—ã", "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∫–∏ –∏ —Ñ–∏—Ç–Ω–µ—Å-–ø–∞—Ä–∫–∏"],
    "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": ["–°–∫—É–ª—å–ø—Ç—É—Ä—ã –∏ —É–ª–∏—á–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ", "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞", "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏", "–†–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è"],
    "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": ["–ö–æ—Ñ–µ", "–£–ª–∏—á–Ω–∞—è –µ–¥–∞", "–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã", "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã"],
    "–°–µ–º–µ–π–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": ["–ü–∞—Ä–∫–∏ –∞—Ç—Ç—Ä–∞–∫—Ü–∏–æ–Ω—ã –∏ –¥–µ—Ç—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∫–∏", "–ó–æ–æ–ø–∞—Ä–∫–∏", "–ú—É–∑–µ–∏ –¥–ª—è –¥–µ—Ç–µ–π", "–ü–∏–∫–Ω–∏–∫–∏ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ", "–ò–≥—Ä–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –∑–æ–Ω—ã"],
    "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": ["–ó–∞–±—Ä–æ—à–µ–Ω–Ω—ã–µ –∑–¥–∞–Ω–∏—è –∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏", "–£—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è", "–¢–∞–π–Ω—ã–µ –∏ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã", "–ù–æ—á–Ω—ã–µ —ç–∫—Å–∫—É—Ä—Å–∏–∏"],
    "–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": ["–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã", "–ö–∏–Ω–æ –∏ —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ", "–ú–∏—Ñ—ã –∏ –ª–µ–≥–µ–Ω–¥—ã", "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã", "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"],
};

// --- –î–ê–ù–ù–´–ï –ú–ê–†–®–†–£–¢–û–í (–ì–ï–ù–ï–†–ê–¶–ò–Ø) ---
// --- –î–ê–ù–ù–´–ï –ú–ê–†–®–†–£–¢–û–í (–ì–ï–ù–ï–†–ê–¶–ò–Ø) ---
const getRoutesData = (cityId, lang) => {
    const t = (txt) => TRANSLATIONS[lang]?.[txt] || txt;

    // 1. –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞—Ç–∞–ª–æ–≥–∞ (—Å–∫–µ–ª–µ—Ç)
    // –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –≤—Å–µ —Ä–∞–∑–¥–µ–ª—ã –≤—Å–µ–≥–¥–∞ —Å—É—â–µ—Å—Ç–≤—É—é—Ç, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ –ø—É—Å—Ç—ã–µ
    const getEmptyStructure = () => ({
        "–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": {
            "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è": [], "–ú—É–∑–µ–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∏": [], "–ü–∞–º—è—Ç–Ω–∏–∫–∏ –∏ –º–µ–º–æ—Ä–∏–∞–ª—ã": [], "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏": [],
            "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∏": [], "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∫–≤–∞—Ä—Ç–∞–ª—ã": [], "–¶–µ—Ä–∫–≤–∏ –∏ —Ö—Ä–∞–º—ã": [], "–õ–µ–≥–µ–Ω–¥—ã –∏ –º–∏—Ñ—ã –≥–æ—Ä–æ–¥–∞": []
        },
        "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": {
            "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏": [], "–ì–æ—Ä–Ω—ã–µ –∏ –ª–µ—Å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": [], "–ê–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö —É –≤–æ–¥—ã": [], "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∫–∏ –∏ —Ñ–∏—Ç–Ω–µ—Å-–ø–∞—Ä–∫–∏": []
        },
        "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": {
            "–°–∫—É–ª—å–ø—Ç—É—Ä—ã –∏ —É–ª–∏—á–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ": [], "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞": [], "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏": [], "–†–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è": []
        },
        "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": {
            "–ö–æ—Ñ–µ": [], "–£–ª–∏—á–Ω–∞—è –µ–¥–∞": [], "–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã": [], "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã": []
        },
        "–°–µ–º–µ–π–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": {
            "–ü–∞—Ä–∫–∏ –∞—Ç—Ç—Ä–∞–∫—Ü–∏–æ–Ω—ã –∏ –¥–µ—Ç—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∫–∏": [], "–ó–æ–æ–ø–∞—Ä–∫–∏": [], "–ú—É–∑–µ–∏ –¥–ª—è –¥–µ—Ç–µ–π": [], "–ü–∏–∫–Ω–∏–∫–∏ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ": [], "–ò–≥—Ä–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –∑–æ–Ω—ã": []
        },
        "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": {
            "–ó–∞–±—Ä–æ—à–µ–Ω–Ω—ã–µ –∑–¥–∞–Ω–∏—è –∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏": [], "–£—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è": [], "–¢–∞–π–Ω—ã–µ –∏ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": [], "–ù–æ—á–Ω—ã–µ —ç–∫—Å–∫—É—Ä—Å–∏–∏": []
        },
        "–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": {
            "–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": [], "–ö–∏–Ω–æ –∏ —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ": [], "–ú–∏—Ñ—ã –∏ –ª–µ–≥–µ–Ω–¥—ã": [], "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": [], "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": []
        }
    });

    const structure = getEmptyStructure();

    // 2. –ù–∞–ø–æ–ª–Ω—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≥–æ—Ä–æ–¥–∞
    if (cityId === 'kemerovo') {
        // --- –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ö–ï–ú–ï–†–û–í–û ---
        const pushkinRoute = { name: "–ü–ª–æ—â–∞–¥—å –∏ –ü–∞–º—è—Ç–Ω–∏–∫ –ü—É—à–∫–∏–Ω—É", distance: 0.5, time: "5 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", videoUrl: "https://rutube.ru/video/39841ce0856abb688f35f07e6d06f474/?r=wd", geoUrl: "https://yandex.ru/maps/-/CLSXRGla", audioUrl: "https://archive.org/download/20251028_20251028_0740/%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%D0%B4%D1%8C%20%D0%BF%D1%83%D1%88%D0%BA%D0%B8%D0%BD%D0%B0.MP3", image: "https://archive.org/download/20251028_20251028_0740/IMG_20251028_130447.jpg", location: { lat: 55.357344, lon: 86.087308 }, descriptionShort: "–£—é—Ç–Ω–∞—è –ø–ª–æ—â–∞–¥—å –≤ —Ü–µ–Ω—Ç—Ä–µ –≥–æ—Ä–æ–¥–∞.", subCategory: "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∏" };
        const minerRoute = { name: "–ü–∞–º—è—Ç—å —à–∞—Ö—Ç—ë—Ä–∞–º –ö—É–∑–±–∞—Å—Å–∞", distance: 1.5, time: "20 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", videoUrl: "https://rutube.ru/video/a296940a183cdc08d317c54345547175/?r=wd", geoUrl: "https://yandex.ru/maps/-/CLSXRS8n", audioUrl: "https://archive.org/download/miner_202510/miner.MP3", image: "https://archive.org/download/miner_202510/7933c1ff3b8662e1762c21e13a75417f.jpg", location: { lat: 55.374074, lon: 86.078468 }, descriptionShort: "–ú–æ–Ω—É–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –ø–∞–º—è—Ç–Ω–∏–∫ —à–∞—Ö—Ç—ë—Ä–∞–º.", subCategory: "–ü–∞–º—è—Ç–Ω–∏–∫–∏ –∏ –º–µ–º–æ—Ä–∏–∞–ª—ã" };
        const importCoffeeRoute = { name: "Import Coffee", distance: 0.1, time: "5 –º–∏–Ω", difficulty: "–û—á–µ–Ω—å –ª—ë–≥–∫–∞—è", videoUrl: "", geoUrl: "https://yandex.ru/maps/-/CLSXRDmw", audioUrl: "https://archive.org/download/20251029_20251029_1604/%D0%B8%D0%BC%D0%BF%D0%BE%D1%80%D1%82%D0%BA%D0%BE%D1%84%D0%B5.MP3", image: "https://archive.org/download/20251029_20251029_1604/caska-kapucino-s-kofe-v-zernah-na-stole.jpg", location: { lat: 55.358212, lon: 86.083722 }, descriptionShort: "–í–∫—É—Å–Ω—ã–π –∫–æ—Ñ–µ –≤ —Ä–∞–π–æ–Ω–µ –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π.", subCategory: "–ö–æ—Ñ–µ" };
        const coffeePrivalRoute = {  name: "–ö–æ—Ñ–µ–π–Ω—ã–π –ø—Ä–∏–≤–∞–ª",  distance: 0.1,  time: "10 –º–∏–Ω",  difficulty: "–õ—ë–≥–∫–∞—è", videoUrl: "https://rutube.ru/video/7cbee9191db8eecab9033d0f237bc979/",   geoUrl: "https://yandex.ru/maps/org/kofeyny_prival/8039828444/?ll=86.085832%2C55.358612&z=16",  audioUrl: "https://archive.org/download/2_20260127_20260127_0510/2.MP3", image: "https://archive.org/download/koffe2/koffe2.png", location: { lat: 55.358612, lon: 86.085832 },  descriptionShort: "–°–∞–º–∞—è –≤–∫—É—Å–Ω–∞—è –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä–Ω–∞—è –∫–æ—Ñ–µ–π–Ω—è –≤ —Ä–∞–π–æ–Ω–µ –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π.", subCategory: "–ö–æ—Ñ–µ"  };
        const fiveFacts = { name: "5 —Ñ–∞–∫—Ç–æ–≤ –æ –ö–µ–º–µ—Ä–æ–≤–æ, –æ –∫–æ—Ç–æ—Ä—ã—Ö —Ç—ã –Ω–µ –∑–Ω–∞–ª",  distance: 0.5,  time: "10 –º–∏–Ω",  difficulty: "–õ—ë–≥–∫–∞—è",  geoUrl: "https://yandex.ru/maps/-/CLSXRGla", audioUrl: "https://raw.githubusercontent.com/artemasovvalera/yasamkem/main/5fakt(1).MP3", videoUrl: "https://rutube.ru/video/52b6f916e4e102125400908a2a16c876/", image: "https://raw.githubusercontent.com/artemasovvalera/yasamkem/main/5fakt.png", location: { lat: 55.354692, lon: 86.088503 }, descriptionShort: "–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç—ã –æ –≥–æ—Ä–æ–¥–µ, –∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞—é—Ç —Ç–æ–ª—å–∫–æ –º–µ—Å—Ç–Ω—ã–µ.", subCategory: "–õ–µ–≥–µ–Ω–¥—ã –∏ –º–∏—Ñ—ã –≥–æ—Ä–æ–¥–∞", isExploreRoute: true };
        const leninMemorialRoute = { name: "–ü–∞–º—è—Ç–Ω–∏–∫ –õ–µ–Ω–∏–Ω—É", distance: 1.2, time: "15 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", videoUrl: "https://rutube.ru/video/b617deb9362e1df28c969ae16db82226/", geoUrl: "https://yandex.ru/maps/-/CLSXRL1p", audioUrl: "https://archive.org/download/lenin_202511/Lenin.MP3", image: "https://archive.org/download/lenin_202511/Lenin.jpg", location: { lat: 55.354692, lon: 86.088503 }, descriptionShort: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ø–∞–º—è—Ç–Ω–∏–∫ –≥–æ—Ä–æ–¥–∞.", subCategory: "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∏" };
        const oldestHouseRoute = { name: "–°–∞–º—ã–π —Å—Ç–∞—Ä—ã–π –¥–æ–º", distance: 0.8, time: "10 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", videoUrl: "https://rutube.ru/video/207c76befeba4aa49f13a0e052c3f21b/", geoUrl: "https://yandex.ru/maps/-/CLSXRXKJ", audioUrl: "https://archive.org/download/dom_20251106/dom.MP3", image: "https://archive.org/download/dom_20251106/Tx_Iuw-HnAzmgKSZsGgXEatwymlG86OJTzNFN1Wma3lQbj7sC8aecRqAmKUOdp6uKgumyxwbfGu2GN26ptLJ71oH.jpg", location: { lat: 55.359329, lon: 86.078126 }, descriptionShort: "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –∑–¥–∞–Ω–∏–µ, —Å–≤–∏–¥–µ—Ç–µ–ª—å –Ω–∞—á–∞–ª–∞ –≥–æ—Ä–æ–¥–∞.", subCategory: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏" };
        const sovKirCrossroadRoute = { name: "–ü–µ—Ä–µ–∫—Ä–µ—Å—Ç–æ–∫ –°–æ–≤–µ—Ç—Å–∫–æ–≥–æ –∏ –ö–∏—Ä–æ–≤–∞", distance: 0.5, time: "5 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", geoUrl: "https://yandex.ru/maps/-/CLSXVEOT", videoUrl: "https://rutube.ru/video/749d390303bbd9a5e1478d8da8e1bcd3/", audioUrl: "https://archive.org/download/sov-kir/sov-kir.MP3", image: "https://archive.org/download/sov-kir/ansambl-sovetskogo-2.jpg", location: { lat: 55.357470, lon: 86.075106 }, descriptionShort: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å.", subCategory: "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∫–≤–∞—Ä—Ç–∞–ª—ã", explicitDate: "2025-11-09" };
        const rampa = { name: "–ü–∞–º—è—Ç–Ω–∏–∫ –õ–æ–±—Å–∞–Ω–≥—É –†–∞–º–ø–µ", distance: 0.5, time: "8 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", geoUrl: "https://yandex.ru/maps/-/CLWX7To5", videoUrl: "https://rutube.ru/video/58164fadc62c4f846920835b059e6b36/?r=wd", audioUrl: "https://archive.org/download/rampa_202511/rampa.MP3", image: "https://archive.org/download/rampa_202511/rampa.jpg", location: { lat: 55.357076, lon: 86.092200 }, descriptionShort: "–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –ø–∞–º—è—Ç–Ω–∏–∫ –ø–∏—Å–∞—Ç–µ–ª—é.", subCategory: "–¢–∞–π–Ω—ã–µ –∏ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã", explicitDate: "2025-11-26" };
        const kuzbassMuseum = { name: "–ö—É–∑–±–∞—Å—Å–∫–∏–π –∫—Ä–∞–µ–≤–µ–¥—á–µ—Å–∫–∏–π –º—É–∑–µ–π", distance: 1.0, time: "12 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", geoUrl: "https://yandex.ru/maps/-/CLSXVMls", audioUrl: "https://archive.org/download/kuzbass-museum-2025/kuzbass_museum_audio.mp3", videoUrl: "https://rutube.ru/video/e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0/", image: "https://archive.org/download/kuzbass-museum-2025/kuzbass_museum_facade.jpg", location: { lat: 55.356116, lon: 86.080279 }, descriptionShort: "–ì–ª–∞–≤–Ω—ã–π –∫—Ä–∞–µ–≤–µ–¥—á–µ—Å–∫–∏–π –º—É–∑–µ–π –ö—É–∑–±–∞—Å—Å–∞ —Å –±–æ–≥–∞—Ç–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π.", subCategory: "–ú—É–∑–µ–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∏" };
        const krasnayaGorkaMuseum1 = { name: "–ú—É–∑–µ–π-–∑–∞–ø–æ–≤–µ–¥–Ω–∏–∫ '–ö—Ä–∞—Å–Ω–∞—è –ì–æ—Ä–∫–∞'", distance: 2.5, time: "30 –º–∏–Ω", difficulty: "–°—Ä–µ–¥–Ω—è—è", geoUrl: "https://yandex.ru/maps/-/CLSXVBLq", audioUrl: "https://archive.org/download/krasnaya-gorka-2025/krasnaya_gorka_audio.mp3", videoUrl: "https://rutube.ru/video/f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1/", image: "https://archive.org/download/krasnaya-gorka-2025/krasnaya_gorka_panorama.jpg", location: { lat: 55.375438, lon: 86.071903 }, descriptionShort: "–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –º—É–∑–µ–π –ø–æ–¥ –æ—Ç–∫—Ä—ã—Ç—ã–º –Ω–µ–±–æ–º –Ω–∞ –º–µ—Å—Ç–µ –±—ã–≤—à–µ–π —à–∞—Ö—Ç—ã.", subCategory: "–ú—É–∑–µ–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∏" };
        const artMuseum = { name: "–ú—É–∑–µ–π –ò–ó–û –ö—É–∑–±–∞—Å—Å–∞", distance: 1.1, time: "14 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", geoUrl: "https://yandex.ru/maps/-/CLSXVR4~", audioUrl: null, image: "https://images.unsplash.com/photo-1579541629828-5645a8f4c522?auto=format&fit=crop&w=1200&q=80", location: { lat: 55.356313, lon: 86.083243 }, descriptionShort: "–ö–æ–ª–ª–µ–∫—Ü–∏–∏ —Ä—É—Å—Å–∫–æ–≥–æ –∏ –∑–∞—Ä—É–±–µ–∂–Ω–æ–≥–æ –∏—Å–∫—É—Å—Å—Ç–≤–∞.", subCategory: "–ú—É–∑–µ–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∏" };
        const artCenter = { name: "–ö—É–∑–±–∞—Å—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä –∏—Å–∫—É—Å—Å—Ç–≤", distance: 1.3, time: "16 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", geoUrl: "https://yandex.ru/maps/-/CLSXVZ~V", audioUrl: null, image: "https://images.unsplash.com/photo-1513364776144-60967b0f800f?auto=format&fit=crop&w=1200&q=80", location: { lat: 55.350957, lon: 86.075196 }, descriptionShort: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∞—Ä—Ç-–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ.", subCategory: "–ú—É–∑–µ–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∏" };
        const bezdomniipec = { name: "–ë–µ–∑–¥–æ–º–Ω—ã–π –ü–µ—Å", distance: 0.3, time: "4 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", image: "https://archive.org/download/5fakt-1/bezdpe.jpg", audioUrl: "https://archive.org/download/00vvedenie-naberejnaya/%D0%B1%D0%B5%D0%B7%D0%B4%D0%BE%D0%BC%D0%BD%D1%8B%D0%B8%CC%86%20%D0%BF%D0%B5%D1%81.MP3", videoUrl: "https://rutube.ru/video/c9a406806ff214ecdc0b11f08874b32e/", location: { lat: 55.359703, lon: 86.086954 }, geoUrl: "https://yandex.ru/maps/-/CLSXVOj8", descriptionShort: "–¢—Ä–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞–º—è—Ç–Ω–∏–∫ –¥–æ–±—Ä–æ—Ç–µ.", subCategory: "–°–∫—É–ª—å–ø—Ç—É—Ä—ã –∏ —É–ª–∏—á–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ", explicitDate: "2025-11-21" };
        const mod = { name: "–ú–æ–¥–Ω–∏—Ü–∞", distance: 0.3, time: "3 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", image: "https://archive.org/download/modnica/XXXL.jpeg", audioUrl: "https://archive.org/download/modnica/modnica.MP3", location: { lat: 55.334873, lon: 86.174779 }, geoUrl: "https://yandex.ru/maps/-/CLgFuH67", descriptionShort: "–ü–∞–º—è—Ç–Ω–∏–∫ –¥–µ–≤–æ—á–∫–µ –≤ –º–∞–º–∏–Ω—ã—Ö —Ç—É—Ñ–ª—è—Ö.", subCategory: "–°–∫—É–ª—å–ø—Ç—É—Ä—ã –∏ —É–ª–∏—á–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ", videoUrl: "https://rutube.ru/video/private/5106ecfe76e6c4d597832abed7e0887a/?p=np-frlzREk_KtGIxq4UfKg", explicitDate: "2025-12-05" };
        const olenLesnaya = { name: "–°–∫—É–ª—å–ø—Ç—É—Ä–∞ –û–ª–µ–Ω—å", distance: 12.0, time: "25 –º–∏–Ω (–∞–≤—Ç–æ)", difficulty: "–õ—ë–≥–∫–∞—è", image: "https://cdn-ru.bitrix24.ru/b35117284/landing/ef2/ef2830181fccd03ee7a3fe12d599ee77/orig_2x.jpeg", audioUrl: "https://archive.org/download/orig_20251118/olen.MP3", location: { lat: 55.416023, lon: 86.238736 }, geoUrl: "https://yandex.ru/maps/-/CLSXV8ov", videoUrl: "https://rutube.ru/video/4c0fb0036f5480277844c2c598f9d30d/", descriptionShort: "–°–∫—É–ª—å–ø—Ç—É—Ä–∞ –≤ —Ä–∞–π–æ–Ω–µ –õ–µ—Å–Ω–∞—è –ü–æ–ª—è–Ω–∞.", subCategory: "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏", explicitDate: "2025-11-22" };
        const chas_usp = { name: "–ß–∞—Å–æ–≤–Ω—è –∏–∫–æ–Ω—ã –ë–æ–∂–∏–µ–π –ú–∞—Ç–µ—Ä–∏", distance: 0.5, time: "6 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", image: "https://archive.org/download/dsc-1432_202511/DSC_1432.JPG", audioUrl: "https://archive.org/download/dsc-1432_202511/chas_usp.MP3", geoUrl: "https://yandex.ru/maps/-/CLSXVLlU", location: { lat: 55.353792, lon: 86.092382 }, descriptionShort: "–ß–∞—Å–æ–≤–Ω—è –í—Å–µ—Ö –°–∫–æ—Ä–±—è—â–∏—Ö –†–∞–¥–æ—Å—Ç—å.", subCategory: "–¶–µ—Ä–∫–≤–∏ –∏ —Ö—Ä–∞–º—ã", explicitDate: "2025-11-23", videoUrl: "https://rutube.ru/video/a667d8bccefbf54646a11b53166558cf/?r=wd" };
        const park_pobedi = { name: "–ü–∞—Ä–∫ –ü–æ–±–µ–¥—ã –∏–º–µ–Ω–∏ –ì–µ–æ—Ä–≥–∏—è –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω–æ–≤–∏—á–∞ –ñ—É–∫–æ–≤–∞", distance: 1.5, time: "30 –º–∏–Ω", difficulty: "—Å–ª–æ–∂–Ω–∞—è", image: "https://archive.org/download/20260210_20260210_1146/001.jpg", audioUrl: "https://archive.org/download/20260210_20260210_1146/%D0%BF%D0%B0%D1%80%D0%BA_%D0%BF%D0%BE%D0%B1%D0%B5%D0%B4%D1%8B.MP3", geoUrl: "https://yandex.ru/maps/-/CPQZBJ4~", location: { lat: 55.348852, lon: 86.094377 }, descriptionShort: "–ü–∞—Ä–∫ —Å –≤–æ–µ–Ω–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–æ–π", subCategory: "–ü–∞—Ä–∫–∏", explicitDate: "2026-02-10", videoUrl: " https://rutube.ru/video/0d0a0b9576446540595107193164ab5e/" };
        const pcoff = { name: "–õ—É—á—à–µ–µ –ö–∞—Ñ–µ - –ü–∞—Ä–∞–¥–Ω–∞—è", distance: 0.5, time: "10 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", image: "https://archive.org/download/cp_20260211/photo_2026-02-11%2013.17.16_thumb.jpg", audioUrl: "https://archive.org/download/cp_20260211/cp.MP3", geoUrl: "https://yandex.ru/maps/-/CPQ7q4M0", location: { lat: 55.358599, lon: 86.085642 }, descriptionShort: "–õ—É—á—à–∏–π –∫–æ—Ñ–µ –≤ —Ä–∞–π–æ–Ω–µ –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π", subCategory: "–ö–æ—Ñ–µ", explicitDate: "2026-02-11", videoUrl: "https://rutube.ru/video/e246f605cbaaf51506c051839f9e2461/" };
        const s_bor = { name: "–°–æ—Å–Ω–æ–≤—ã–π –ë–æ—Ä", distance: 5.5, time: "60 –º–∏–Ω", difficulty: "–°–ª–æ–∂–Ω–∞—è", image: "https://archive.org/download/sb_20260220/sb.jpg", audioUrl: "https://archive.org/download/sb_20260220/sb.MP3", geoUrl: "https://yandex.com/maps/-/CPanVZ31", location: { lat: 55.378308, lon: 86.104392 }, descriptionShort: "–°–∞–º—ã–π –±–æ–ª—å—à–æ–π –≤ –º–∏—Ä–µ —Ö–≤–æ–π–Ω—ã–π –≥–æ—Ä–æ–¥—Å–∫–æ–π –ø–∞—Ä–∫!", subCategory: "–ü–∞—Ä–∫–∏", explicitDate: "2026-02-19", videoUrl: "" };
        const mmuz = { name: "–ú–∏–¢–û–ö ‚Äî —Å—Ç—Ä–æ–π–∫–∞, –∫–æ—Ç–æ—Ä—É—é –≤—Å–µ –≤–∏–¥–µ–ª–∏, –Ω–æ –Ω–∏–∫—Ç–æ –Ω–µ –∑–Ω–∞–µ—Ç", distance: 0.5, time: "10 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", image: "https://archive.org/download/m1_20260226/m1.png", audioUrl: "https://archive.org/download/m1_20260226/1.MP3", geoUrl: "https://yandex.com/maps/-/CPeSrGpJ", location: { lat: 55.351509, lon: 86.100853 }, descriptionShort: "–ú–∏—Ä–æ–≤–æ–π —Ä–µ–∫–æ—Ä–¥ –ø—Ä—è–º–æ –≤ —Ü–µ–Ω—Ç—Ä–µ –ö–µ–º–µ—Ä–æ–≤–∞", subCategory: "–ú—É–∑–µ–π", explicitDate: "2026-02-27", videoUrl: "https://rutube.ru/video/cf7e0d0c483280763d4ec451fb241f0a/" };

        // –ú–∞—Ä—à—Ä—É—Ç—ã –ù–∞–±–µ—Ä–µ–∂–Ω–æ–π
        const nabIntro = { name: "–í–≤–µ–¥–µ–Ω–∏–µ –≤ –ù–∞–±–µ—Ä–µ–∂–Ω—É—é", distance: 0.1, time: "2 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", image: "https://raw.githubusercontent.com/artemasovvalera/yasamkem/main/%D0%BD%D0%B0%D0%B1%D0%B5%D1%80%D0%B5%D0%B6%D0%BD%D0%B0%D1%8F.jpg", audioUrl: "https://raw.githubusercontent.com/artemasovvalera/yasamkem/main/vvednaber.MP3", location: { lat: 55.365094, lon: 86.076369 }, videoUrl: "https://rutube.ru/video/340092f174a1c1614460c1d503f66ce0/", geoUrl: "https://yandex.ru/maps/-/CLSXZEJU", descriptionShort: "–ù–∞—á–∞–ª–æ –ø—Ä–æ–≥—É–ª–∫–∏ –ø–æ –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π.", subCategory: "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è" };
        const nabteremok = { name: "–¢–µ—Ä–µ–º–æ–∫", distance: 0.1, time: "2 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", image: "https://raw.githubusercontent.com/artemasovvalera/yasamkem/main/terem.jpg", audioUrl: "", location: { lat: 55.365094, lon: 86.076369 }, videoUrl: "https://rutube.ru/video/private/153d44b2c761310c5c55d9ae58f9e36e/?r=wd", geoUrl: "https://yandex.ru/maps/-/CLSXZEJU", descriptionShort: "–í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ–µ —á—É–≥—É–Ω–Ω–æ–µ –ª–∏—Ç—å–µ - —Ñ–æ–Ω–∞—Ä–∏ –ø–æ –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π.", subCategory: "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è" };
        const nabfonar = { name: "–§–æ–Ω–∞—Ä–Ω—ã–µ —Å—Ç–æ–ª–±—ã –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π", distance: 0.1, time: "2 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", image: "https://archive.org/download/20260107_20260107_0715/fonari.JPG", audioUrl: "https://archive.org/download/00vvedenie-naberejnaya/fonary.MP3", location: { lat: 55.365094, lon: 86.076369 }, videoUrl: "https://rutube.ru/video/private/153d44b2c761310c5c55d9ae58f9e36e/?r=wd", geoUrl: "https://yandex.ru/maps/-/CLSXZEJU", descriptionShort: "–í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ–µ —á—É–≥—É–Ω–Ω–æ–µ –ª–∏—Ç—å–µ - —Ñ–æ–Ω–∞—Ä–∏ –ø–æ –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π.", subCategory: "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è" };
        const nabBridges = { name: "–î–≤–∞ –º–æ—Å—Ç–∞", distance: 0.5, time: "5 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", image: "https://raw.githubusercontent.com/artemasovvalera/yasamkem/main/2mos.jpg", audioUrl: "https://dn710206.ca.archive.org/0/items/00vvedenie-naberejnaya/00vvedenie_naberejnaya.MP3", location: { lat: 55.365094, lon: 86.076369 }, videoUrl: "https://rutube.ru/video/c0f701e82cfc8590fb98fb0af0e09af2/?r=wd", geoUrl: "https://yandex.ru/maps/-/CLSXZEJU", descriptionShort: "–î–≤–∞ –º–æ—Å—Ç–∞ –≤ –Ω–∞—á–∞–ª–µ –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π. –ü—Ä–æ—à–ª–æ–µ –∏ –±—É–¥—É—â–µ–µ —Ä—è–¥–æ–º.", subCategory: "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è" };
        const nabFences = { name: "–û–≥—Ä–∞–¥—ã –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π", distance: 0.2, time: "8 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", image: "https://archive.org/download/5fakt-1/ogr.jpg", audioUrl: "https://archive.org/download/ograjdenie_end/ograjdenie_end.MP3", location: { lat: 55.364308, lon: 86.077555 }, videoUrl: "https://rutube.ru/video/54e7ffe5157d385aca13656c8cf2e0f9/?r=wd", geoUrl: "https://yandex.ru/maps/-/CLSXZY0U", descriptionShort: "–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —á—É–≥—É–Ω–Ω—ã–µ –æ–≥—Ä–∞–∂–¥–µ–Ω–∏—è.", subCategory: "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è" };
        const nabCinema = { name: "–ó–¥–∞–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–∞", distance: 0.5, time: "6 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", image: "https://archive.org/download/5fakt-1/kino.jpg", audioUrl: "https://archive.org/download/00vvedenie-naberejnaya/antik.MP3", location: { lat: 55.362439, lon: 86.080820 }, videoUrl: "https://rutube.ru/video/private/8c329af55ade6c069b45d1fdd9f83892/?r=wd", geoUrl: "https://yandex.ru/maps/-/CLSXZO5T", descriptionShort: "–û–¥–∏–Ω –∏–∑ —Å—Ç–∞—Ä–µ–π—à–∏—Ö –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–æ–≤ –≥–æ—Ä–æ–¥–∞.", subCategory: "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è" };
        const nabHeart = { name: "–ê—Ä—Ç-–æ–±—å–µ–∫—Ç –Ø –õ—é–±–ª—é –ö–µ–º–µ—Ä–æ–≤–æ", distance: 0.2, time: "4 –º–∏–Ω", difficulty: "–õ—ë–≥–∫–∞—è", image: "https://archive.org/download/20251107_20251107_1108/%D1%8F%20%D0%BB%D1%8E%D0%B1%D0%BB%D1%8E%20%D0%BA%D0%B5%D0%BC%D0%B5%D1%80%D0%BE%D0%B2%D0%BE.png", audioUrl: "https://archive.org/download/ograjdenie_end/%D1%81%D0%B5%D1%80%D0%B4%D1%86%D0%B5.MP3", location: { lat: 55.359595, lon: 86.087298 }, videoUrl: "https://rutube.ru/video/a38198ad8df1e004b93c0e56940f331c/?r=wd", geoUrl: "https://yandex.ru/maps/-/CLSXZXIO", descriptionShort: "–ü–æ–ø—É–ª—è—Ä–Ω—ã–π –∞—Ä—Ç-–æ–±—ä–µ–∫—Ç.", subCategory: "–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è" };

        // --- –ó–ê–ü–û–õ–ù–ï–ù–ò–ï –ö–ê–¢–ê–õ–û–ì–ê –ö–ï–ú–ï–†–û–í–û ---
        structure["–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ù–∞–±–µ—Ä–µ–∂–Ω–∞—è"] = [rampa, bezdomniipec, nabIntro, nabBridges, nabfonar, nabteremok, nabFences, nabCinema, nabHeart];
        structure["–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ú—É–∑–µ–∏ –∏ –≤—ã—Å—Ç–∞–≤–∫–∏"] = [mmuz, kuzbassMuseum, artMuseum, artCenter];
        structure["–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ü–∞–º—è—Ç–Ω–∏–∫–∏ –∏ –º–µ–º–æ—Ä–∏–∞–ª—ã"] = [rampa, pushkinRoute, minerRoute, leninMemorialRoute, chas_usp, park_pobedi];
        structure["–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"] = [mmuz, mod, chas_usp, minerRoute, pushkinRoute, leninMemorialRoute, oldestHouseRoute, olenLesnaya];
        structure["–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ì–æ—Ä–æ–¥—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∏"] = [pushkinRoute, minerRoute, leninMemorialRoute, park_pobedi];
        structure["–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∫–≤–∞—Ä—Ç–∞–ª—ã"] = [sovKirCrossroadRoute];
        structure["–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–¶–µ—Ä–∫–≤–∏ –∏ —Ö—Ä–∞–º—ã"] = [chas_usp];
        structure["–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–õ–µ–≥–µ–Ω–¥—ã –∏ –º–∏—Ñ—ã –≥–æ—Ä–æ–¥–∞"] = [rampa, olenLesnaya];
        
        structure["–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏"] = [s_bor, mod, olenLesnaya, park_pobedi];
        structure["–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ì–æ—Ä–Ω—ã–µ –∏ –ª–µ—Å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"] = [s_bor];
         structure["–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –ø–ª–æ—â–∞–¥–∫–∏ –∏ —Ñ–∏—Ç–Ω–µ—Å-–ø–∞—Ä–∫–∏"] = [s_bor];
        
        structure["–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–°–∫—É–ª—å–ø—Ç—É—Ä—ã –∏ —É–ª–∏—á–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ"] = [mod, minerRoute, pushkinRoute, leninMemorialRoute, bezdomniipec, olenLesnaya];
        structure["–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞"] = [mmuz, mod, bezdomniipec];
        structure["–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–†–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è"] = [oldestHouseRoute, sovKirCrossroadRoute];
        
        structure["–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ö–æ—Ñ–µ"] = [pcoff, importCoffeeRoute, coffeePrivalRoute];
        
        structure["–°–µ–º–µ–π–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ü–∞—Ä–∫–∏ –∞—Ç—Ç—Ä–∞–∫—Ü–∏–æ–Ω—ã –∏ –¥–µ—Ç—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∫–∏"] = [s_bor, olenLesnaya, park_pobedi];
        structure["–°–µ–º–µ–π–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ò–≥—Ä–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –∑–æ–Ω—ã"] = [olenLesnaya];
        structure["–°–µ–º–µ–π–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ü–∏–∫–Ω–∏–∫–∏ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ"] = [s_bor];
        
        structure["–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–£—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è"] = [mmuz, s_bor, chas_usp, olenLesnaya, oldestHouseRoute, sovKirCrossroadRoute];
        structure["–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–¢–∞–π–Ω—ã–µ –∏ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"] = [rampa];
        
        structure["–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ú–∏—Ñ—ã –∏ –ª–µ–≥–µ–Ω–¥—ã"] = [rampa, olenLesnaya];
        structure["–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"] = [s_bor];
        
        structure["–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–õ–µ–≥–µ–Ω–¥—ã –∏ –º–∏—Ñ—ã –≥–æ—Ä–æ–¥–∞"].push(fiveFacts);

    } else if (cityId === 'arambol') {
        // --- –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ê–†–ê–ú–ë–û–õ–Ø ---
        const arambolBeach = { name: t("Arambol Beach"), distance: 1.5, time: "6 " + t("min"), difficulty: t("Medium"), image: "https://archive.org/download/goa-1024x-680/Goa-1024x680.jpg", geoUrl: "https://maps.app.goo.gl/mVoYhBf7nAqKiKWx7", location: { lat: 15.6829383, lon: 73.6929683 }, descriptionShort: t("Best beach in North Goa"), explicitDate: "2025-12-13", audioUrl: (lang === 'hi' ? "https://archive.org/download/goa-1024x-680/arambol_h.MP3" : lang === 'en' ? "https://archive.org/download/goa-1024x-680/arambol_eng.MP3" : "https://archive.org/download/goa-1024x-680/arambol_rus.MP3"), videoUrl: (lang === 'hi' ? "https://rutube.ru/video/private/8d7256abdb3cc51cda3ebf4a5a3bb57c/?p=mjNDU-S38A_xHjVQdvglpQ" : lang === 'en' ? "https://rutube.ru/video/private/d0634cc6d8907afeba29adcf7b675908/?p=co84PNALaar0OPeQwD5y2A" : "https://rutube.ru/video/eaa62c560c6d5cc5ced9164e4a850c16/"), subCategory: "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏" };
        const baba = { name: t("Baba Tree"), distance: 3.5, time: "60 " + t("min"), difficulty: t("High"), image: "https://archive.org/download/baba_ru/787r65.webp", geoUrl: "https://maps.app.goo.gl/jsmedcda8JxSMwkk6", location: { lat: 15.7014833, lon: 73.6987244 }, descriptionShort: t("Baba Description"), explicitDate: "2025-12-14", audioUrl: (lang === 'hi' ? "https://archive.org/download/baba_ru/baba_h.MP3" : lang === 'en' ? "https://archive.org/download/baba_ru/baba_en.MP3" : "https://archive.org/download/baba_ru/baba_ru.MP3"), videoUrl: (lang === 'hi' ? "https://rutube.ru/video/a50d78643366b84f590e1016b1912753/" : lang === 'en' ? "https://rutube.ru/video/df27fd14fef5903f9811bcf7644e2f04/" : "https://rutube.ru/video/0e7ec12a570e26c8e1d4d9f3f764d152/"), subCategory: "–¢–∞–π–Ω—ã–µ –∏ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã" };
        const rocks = { name: t("Arambol Rocks"), distance: 1.0, time: "25 " + t("min"), difficulty: t("Medium"), image: "https://archive.org/download/rocks_202512/rocks.png", geoUrl: "https://maps.app.goo.gl/Kzi3dSTYhv5sTZZt7", location: { lat: 15.69227, lon: 73.6984093 }, descriptionShort: t("Rocks Description"), explicitDate: "2025-12-15", audioUrl: (lang === 'hi' ? "https://archive.org/download/rocks_202512/arambol_rocks_h.MP3" : lang === 'en' ? "https://archive.org/download/rocks_202512/arambol_rocks_en.MP3" : "https://archive.org/download/rocks_202512/arambol_rocks_ru.MP3"), videoUrl: (lang === 'hi' ? "https://rutube.ru/video/48ca5716013a776edd36f0b90b2df8ec/" : lang === 'en' ? "https://rutube.ru/video/9c621002437d96927b43391613f6124f/" : "https://rutube.ru/video/816d068ad920f92154606ac96e15501c/"), subCategory: "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏" };

        structure["–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏"] = [arambolBeach, baba, rocks];
        structure["–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ì–æ—Ä–Ω—ã–µ –∏ –ª–µ—Å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"] = [baba];
        structure["–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ê–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö —É –≤–æ–¥—ã"] = [arambolBeach, rocks];
        
        structure["–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–¢–∞–π–Ω—ã–µ –∏ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"] = [baba];
        
        structure["–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ú–∏—Ñ—ã –∏ –ª–µ–≥–µ–Ω–¥—ã"] = [baba];
        structure["–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"] = [arambolBeach];
        structure["–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–õ–µ–≥–µ–Ω–¥—ã –∏ –º–∏—Ñ—ã –≥–æ—Ä–æ–¥–∞"] = [baba];
        structure["–°–µ–º–µ–π–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ü–∏–∫–Ω–∏–∫–∏ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ"] = [arambolBeach, rocks];

    } else if (cityId === 'moscow') {
        const redSquare = { name: t("Red Square"), distance: 0.5, time: "10 min", image: "https://images.unsplash.com/photo-1513326738677-b964603b136d?w=1200", location: { lat: 55.7539, lon: 37.6208 }, descriptionShort: "Heart of Moscow.", subCategory: "–ü–∞–º—è—Ç–Ω–∏–∫–∏ –∏ –º–µ–º–æ—Ä–∏–∞–ª—ã" };
        const zaryadye = { name: t("Zaryadye"), distance: 0.8, time: "15 min", image: "https://images.unsplash.com/photo-1520106212299-d99c443e4568?w=1200", location: { lat: 55.7511, lon: 37.6287 }, descriptionShort: "Modern park.", subCategory: "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏" };
        
        structure["–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ü–∞–º—è—Ç–Ω–∏–∫–∏ –∏ –º–µ–º–æ—Ä–∏–∞–ª—ã"] = [redSquare];
        structure["–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–æ–Ω—ã –∏ –ø–∞—Ä–∫–∏"] = [zaryadye];
        
    } else if (cityId === 'yerevan') {
        const cascade = { name: t("Cascade"), distance: 1.0, time: "20 min", image: "https://images.unsplash.com/photo-1580137189272-c9379f8864fd?w=1200", location: { lat: 40.1925, lon: 44.5165 }, descriptionShort: "Giant stairway.", subCategory: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏" };
        structure["–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"] = [cascade];
        
    } else if (cityId === 'dusseldorf') {
        const tower = { name: t("Rheinturm"), distance: 0.2, time: "10 min", image: "https://images.unsplash.com/photo-1555818671-55b35242735a?w=1200", location: { lat: 51.2179, lon: 6.7617 }, descriptionShort: "Telecommunications tower.", subCategory: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏" };
        structure["–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã"]["–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"] = [tower];
    }

    return structure;
};

const Modal = ({ show, message, onClose, darkMode, buttonText, lang }) => {
    if (!show) return null;
    const C = darkMode ? S.dark : S.light;
    const t = (k) => TRANSLATIONS[lang]?.[k] || k;
    const btnTxt = buttonText || t('close');
    return (<div style={{ position: 'fixed', top: 0, right: 0, bottom: 0, left: 0, backgroundColor: 'rgba(0, 0, 0, 0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 150, padding: '1rem' }}> <div style={{ borderRadius: '0.75rem', boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.25)', padding: '1.5rem', position: 'relative', width: '100%', maxWidth: '24rem', backgroundColor: C.cardBg, border: `1px solid ${C.cardBorder}`, color: C.text }}> <button onClick={onClose} style={{ position: 'absolute', top: '0.75rem', right: '0.75rem', padding: '0.25rem', borderRadius: '9999px', color: C.textMuted, background: 'none', border: 'none', cursor: 'pointer' }}><XCircle style={{ width: '1.5rem', height: '1.5rem' }} /></button> <p style={{ fontSize: '1.125rem', fontWeight: 600, textAlign: 'center', marginTop: '1rem', marginBottom: '1.5rem' }}>{message}</p> <button onClick={onClose} style={{ width: '100%', backgroundColor: S.emerald600, color: 'white', fontWeight: 600, padding: '0.75rem 0', borderRadius: '0.75rem', border: 'none', cursor: 'pointer' }}>{btnTxt}</button> </div> </div>);
};

const ContactModal = ({ show, onClose, darkMode, lang }) => {
    const [copyStatus, setCopyStatus] = useState({});
    if (!show) return null;
    const C = darkMode ? S.dark : S.light;
    const t = (k) => TRANSLATIONS[lang]?.[k] || k;
    const contactLinks = [{ label: "Email", value: "memorial142@mail.ru", copyValue: "memorial142@mail.ru", url: "mailto:memorial142@mail.ru", icon: <Mail style={{ width: '1.25rem', height: '1.25rem', color: S.sky600 }} /> }, { label: "Telegram", value: "@Ya_Sam_42", copyValue: "Ya_Sam_42", url: "https://t.me/Ya_Sam_42", icon: <Send style={{ width: '1.25rem', height: '1.25rem', color: '#229ED9' }} /> }, { label: "Rutube", value: "–ö–∞–Ω–∞–ª '–Ø –°–ê–ú'", copyValue: "https://rutube.ru/channel/69549307/", url: "https://rutube.ru/channel/69549307/", icon: <Clapperboard style={{ width: '1.25rem', height: '1.25rem', color: S.orange500 }} /> },];
    const handleCopy = (text, label) => { navigator.clipboard.writeText(text).then(() => { setCopyStatus(prev => ({ ...prev, [label]: '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!' })); setTimeout(() => setCopyStatus(prev => ({ ...prev, [label]: null })), 2000); }); };
    const handleOpen = (url) => { window.open(url, '_blank', 'noopener,noreferrer'); };
    return (<div style={{ position: 'fixed', top: 0, right: 0, bottom: 0, left: 0, backgroundColor: 'rgba(0, 0, 0, 0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 150, padding: '1rem' }} onClick={onClose}> <div style={{ borderRadius: '0.75rem', boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.25)', padding: '1.5rem', position: 'relative', width: '100%', maxWidth: '28rem', backgroundColor: C.cardBg, border: `1px solid ${C.cardBorder}`, color: C.text }} onClick={e => e.stopPropagation()}> <h3 style={{ ...S.textXl, ...S.fontBold, marginBottom: '1.5rem', textAlign: 'center' }}>{t('contact')}</h3> <div style={{ display: 'flex', flexDirection: 'column', gap: '1.5rem' }}> {contactLinks.map(link => (<div key={link.label}> <div style={{ ...S.flex, ...S.itemsCenter, gap: '0.75rem', marginBottom: '0.5rem' }}> {link.icon} <div> <p style={{ ...S.fontSemibold, color: C.text }}>{link.label}</p> <p style={{ fontSize: '0.875rem', color: C.textMuted, wordBreak: 'break-all' }}>{link.value}</p> </div> </div> <div style={{ ...S.flex, gap: '0.5rem', marginTop: '0.5rem' }}> <button onClick={() => handleCopy(link.copyValue, link.label)} style={{ flex: 1, backgroundColor: S.emerald600, color: 'white', ...S.fontSemibold, ...S.py3, ...S.roundedXl, border: 'none', cursor: 'pointer', fontSize: '0.875rem' }}> {copyStatus[link.label] || '–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å'} </button> <button onClick={() => handleOpen(link.url)} style={{ flex: 1, backgroundColor: 'transparent', color: C.text, ...S.fontSemibold, ...S.py3, ...S.roundedXl, border: `1px solid ${C.cardBorder}`, cursor: 'pointer', fontSize: '0.875rem' }}> –û—Ç–∫—Ä—ã—Ç—å </button> </div> </div>))} </div> <button onClick={onClose} style={{ width: '100%', marginTop: '2rem', backgroundColor: 'transparent', color: C.textMuted, ...S.fontSemibold, ...S.py3, ...S.roundedXl, border: `1px solid ${C.cardBorder}`, cursor: 'pointer' }}>{t('close')}</button> </div> </div>);
};

const NotificationPermissionModal = ({ show, onAllow, onLater, darkMode, lang }) => {
    if (!show) return null;
    const C = darkMode ? S.dark : S.light;
    const t = (k) => TRANSLATIONS[lang]?.[k] || k;
    
    return (
        <div style={{ 
            position: 'fixed', top: 0, right: 0, bottom: 0, left: 0, 
            backgroundColor: 'rgba(0, 0, 0, 0.4)', 
            display: 'flex', alignItems: 'center', justifyContent: 'center', 
            zIndex: 160, padding: '1rem',
            backdropFilter: 'blur(4px)'
        }} onClick={onLater}>
            <div style={{ 
                borderRadius: '1.5rem', 
                boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.25)', 
                padding: '2rem 1.5rem', 
                width: '100%', maxWidth: '22rem', 
                backgroundColor: C.cardBg, 
                border: `1px solid ${C.cardBorder}`, 
                color: C.text,
                textAlign: 'center'
            }} onClick={e => e.stopPropagation()}>
                <div style={{ fontSize: '3rem', marginBottom: '1rem' }}>üîî</div>
                <h3 style={{ fontSize: '1.25rem', fontWeight: 700, marginBottom: '1rem' }}>
                    {t('notif_permission_title')}
                </h3>
                <p style={{ fontSize: '0.95rem', lineHeight: '1.6', color: C.textMuted, marginBottom: '1.5rem', whiteSpace: 'pre-line' }}>
                    {t('notif_permission_text')}
                </p>
                <div style={{ display: 'flex', gap: '0.75rem', flexDirection: 'column' }}>
                    <button onClick={onAllow} style={{ 
                        width: '100%', backgroundColor: S.emerald600, color: 'white', 
                        fontWeight: 600, padding: '0.875rem 0', borderRadius: '0.75rem', 
                        border: 'none', cursor: 'pointer', fontSize: '1rem'
                    }}>
                        {t('notif_allow')}
                    </button>
                    <button onClick={onLater} style={{ 
                        width: '100%', backgroundColor: 'transparent', color: C.textMuted, 
                        fontWeight: 500, padding: '0.75rem 0', borderRadius: '0.75rem', 
                        border: `1px solid ${C.cardBorder}`, cursor: 'pointer', fontSize: '0.9rem'
                    }}>
                        {t('notif_later')}
                    </button>
                </div>
            </div>
        </div>
    );
};

const SelectionModal = ({ show, onClose, title, items, onSelect, currentId, darkMode, lang }) => {
    if (!show) return null;
    const C = darkMode ? S.dark : S.light;
    const t = (key) => TRANSLATIONS[lang]?.[key] || key;
    return (
        <div style={{ position: 'fixed', top: 0, right: 0, bottom: 0, left: 0, backgroundColor: 'rgba(0,0,0,0.6)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 200, padding: '1rem' }} onClick={onClose}>
            <div style={{ backgroundColor: C.cardBg, borderRadius: '1.5rem', width: '100%', maxWidth: '20rem', padding: '1.5rem', color: C.text, border: `1px solid ${C.cardBorder}` }} onClick={e => e.stopPropagation()}>
                <h3 style={{ fontSize: '1.25rem', fontWeight: 700, textAlign: 'center', marginBottom: '1.5rem' }}>{title}</h3>
                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
                    {items.map(item => (
                        <button key={item.id || item.code} onClick={() => { onSelect(item.id || item.code); onClose(); }} style={{ padding: '1rem', borderRadius: '1rem', border: `1px solid ${C.cardBorder}`, backgroundColor: (currentId === (item.id || item.code)) ? S.emerald600 : C.bg, color: (currentId === (item.id || item.code)) ? 'white' : C.text, fontWeight: 600, cursor: 'pointer', display: 'flex', alignItems: 'center', gap: '1rem' }}>
                            {item.icon && <span style={{ fontSize: '1.5rem' }}>{item.icon}</span>}
                            <span>{item.id ? t('city_' + item.id) : (item.label || item.name)}</span>
                        </button>
                    ))}
                </div>
                <button onClick={onClose} style={{ marginTop: '1.5rem', width: '100%', padding: '0.75rem', background: 'none', border: 'none', color: C.textMuted, cursor: 'pointer' }}>{t('cancel') || "Cancel"}</button>
            </div>
        </div>
    );
};

// --- –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ê–£–î–ò–û–ü–õ–ï–ï–† ---
const MiniAudioPlayer = forwardRef(({ route, onClose, darkMode, onAudioError }, ref) => {
    const [isPlaying, setIsPlaying] = useState(false);
    const [progress, setProgress] = useState(0);
    const [duration, setDuration] = useState(0);
    const [isBuffering, setIsBuffering] = useState(false);
    
    const { name: title, image, subCategory: artist, audioUrl } = route;

    useEffect(() => {
        const audioEl = ref.current;
        if (!audioEl || !audioUrl) return;

        const playAudio = () => {
            const playPromise = audioEl.play();
            if (playPromise !== undefined) {
                playPromise
                    .then(() => setIsPlaying(true))
                    .catch(e => {
                        console.log("Auto-play prevented or interrupted", e);
                        setIsPlaying(false);
                    });
            }
        };

        const handleTimeUpdate = () => {
            setProgress(audioEl.currentTime);
            if (isBuffering && audioEl.readyState >= 3) setIsBuffering(false);
        };
        const handleLoadedMetadata = () => setDuration(audioEl.duration);
        const handleWaiting = () => setIsBuffering(true);
        const handlePlaying = () => { setIsPlaying(true); setIsBuffering(false); };
        const handlePause = () => setIsPlaying(false);
        const handleEnded = () => { setIsPlaying(false); onClose(); };
        const handleError = (e) => {
            console.error("Audio error", e);
            // –ü—ã—Ç–∞–µ–º—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å, –µ—Å–ª–∏ –æ—à–∏–±–∫–∞ —Å–µ—Ç–∏
            if (audioEl.error && audioEl.error.code === 4) {
                 // network error, maybe try once?
            }
            // –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É —Å—Ä–∞–∑—É, –¥–∞–µ–º —à–∞–Ω—Å –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏
            if (audioEl.readyState === 0) {
                 // onAudioError();
            }
        };

        // –°–±—Ä–æ—Å
        setIsPlaying(false);
        setProgress(0);
        setIsBuffering(true);
        
        audioEl.src = audioUrl;
        audioEl.load(); // Force load
        playAudio();

        audioEl.addEventListener("timeupdate", handleTimeUpdate);
        audioEl.addEventListener("loadedmetadata", handleLoadedMetadata);
        audioEl.addEventListener("waiting", handleWaiting);
        audioEl.addEventListener("playing", handlePlaying);
        audioEl.addEventListener("pause", handlePause);
        audioEl.addEventListener("ended", handleEnded);
        audioEl.addEventListener("error", handleError);

        if ('mediaSession' in navigator) {
            navigator.mediaSession.metadata = new window.MediaMetadata({
                title: title || '–ê—É–¥–∏–æ–≥–∏–¥',
                artist: artist || '–Ø –°–ê–ú',
                artwork: [{ src: image || '', type: 'image/jpeg' }]
            });
            navigator.mediaSession.setActionHandler('play', playAudio);
            navigator.mediaSession.setActionHandler('pause', () => audioEl.pause());
        }

        return () => {
            audioEl.removeEventListener("timeupdate", handleTimeUpdate);
            audioEl.removeEventListener("loadedmetadata", handleLoadedMetadata);
            audioEl.removeEventListener("waiting", handleWaiting);
            audioEl.removeEventListener("playing", handlePlaying);
            audioEl.removeEventListener("pause", handlePause);
            audioEl.removeEventListener("ended", handleEnded);
            audioEl.removeEventListener("error", handleError);
        };
    }, [audioUrl, title, artist, image, ref]); // Removed onClose from dependency to prevent re-runs

    const toggle = () => {
        const el = ref.current;
        if (!el) return;
        if (isPlaying) el.pause();
        else el.play();
    };

    const handleScrub = (e) => {
        const scrubTime = parseFloat(e.target.value);
        ref.current.currentTime = scrubTime;
        setProgress(scrubTime);
    };

    const downloadAudio = () => { window.open(audioUrl, '_system'); };

    const C = darkMode ? S.dark : S.light;
    const barColor = darkMode ? "#059669" : "#10b981";

    return (
        <div style={{ position: 'fixed', bottom: 'calc(5rem + env(safe-area-inset-bottom, 0px))', left: '1rem', right: '1rem', padding: '1rem', zIndex: 100, borderRadius: '1rem', boxShadow: '0 -10px 15px -3px rgba(0, 0, 0, 0.1), 0 -4px 6px -2px rgba(0, 0, 0, 0.05)', backgroundColor: C.cardBg, borderTop: `1px solid ${C.cardBorder}`, display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
            <button onClick={toggle} style={{ background: 'none', border: 'none', cursor: 'pointer', padding: '0.5rem', borderRadius: '9999px', color: C.text }}>
                {isBuffering ? <Loader className="animate-spin" style={{width: '1.5rem', height: '1.5rem'}} /> : (isPlaying ? <Pause style={{ width: '1.5rem', height: '1.5rem' }} /> : <PlayCircle style={{ width: '1.5rem', height: '1.5rem' }} />)}
            </button>
            <div style={{ flex: 1, margin: '0 1rem' }}>
                <input type="range" min="0" max={duration || 0} value={progress} onChange={handleScrub} style={{ width: '100%', height: '4px', cursor: 'pointer', background: `linear-gradient(to right, ${barColor} ${((progress / duration) * 100) || 0}%, #d1d5db ${((progress / duration) * 100) || 0}%)` }} />
                <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '0.25rem' }}>
    <span style={{ fontSize: '0.75rem', color: C.text }}>
        {Math.floor(progress / 60)}:{String(Math.floor(progress % 60)).padStart(2, '0')}
    </span>
    <span style={{ fontSize: '0.75rem', color: C.text }}>
        {Math.floor(duration / 60)}:{String(Math.floor(duration % 60)).padStart(2, '0')}
    </span>
</div>
            </div>
            <button onClick={downloadAudio} style={{ background: 'none', border: 'none', cursor: 'pointer', padding: '0.5rem', color: C.text }}><Download style={{ width: '1.25rem', height: '1.25rem' }} /></button>
            <button onClick={onClose} style={{ background: 'none', border: 'none', cursor: 'pointer', padding: '0.5rem', color: C.text }}><XCircle style={{ width: '1.5rem', height: '1.5rem' }} /></button>
            {/* preload="auto" is key for slow connections */}
            <audio ref={ref} preload="auto" playsInline />
        </div>
    );
});

const LiquidMenu = ({ activeTab, onTabChange, onSearchClick, darkMode, lang }) => {
    const [isOpen, setIsOpen] = useState(false);
    const C = darkMode ? S.dark : S.light;
    const t = (k) => TRANSLATIONS[lang]?.[k] || k;

    const leftTabs = [
        { id: 'recommendations', icon: Home, label: t('rec') },
        { id: 'catalog', icon: Landmark, label: t('cat') },
    ];
    
    const rightTabs = [
        { id: 'search', icon: Search, label: t('search'), isSearch: true },
        { id: 'map', icon: MapIcon, label: t('map') },
    ];

    const handleTabClick = (tab) => {
        if (tab.isSearch) {
            onSearchClick();
        } else {
            onTabChange(tab.id);
        }
        setIsOpen(false);
    };

    const renderTabButton = (tab, index, side) => {
        const isActive = activeTab === tab.id;
        const Icon = tab.icon;
        const delay = index * 0.05;
        
        return (
            <div
                key={tab.id}
                onClick={(e) => {
                    e.stopPropagation();
                    handleTabClick(tab);
                }}
                style={{
                    display: 'flex',
                    flexDirection: 'column',
                    alignItems: 'center',
                    gap: '0.25rem',
                    padding: '0.5rem',
                    borderRadius: '0.75rem',
                    cursor: 'pointer',
                    backgroundColor: isActive 
                        ? (darkMode ? 'rgba(16, 185, 129, 0.2)' : 'rgba(16, 185, 129, 0.15)')
                        : (darkMode ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.05)'),
                    backdropFilter: 'blur(10px)',
                    opacity: isOpen ? 1 : 0,
                    transform: isOpen 
                        ? 'translateX(0) scale(1)' 
                        : `translateX(${side === 'left' ? '30px' : '-30px'}) scale(0.5)`,
                    transition: `all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55) ${delay}s`,
                    pointerEvents: isOpen ? 'auto' : 'none',
                    minWidth: '52px',
                }}
            >
                <Icon 
                    size={22} 
                    color={isActive ? '#10B981' : (darkMode ? 'rgba(255,255,255,0.8)' : 'rgba(0,0,0,0.6)')} 
                />
                <span style={{
                    fontSize: '0.6rem',
                    fontWeight: isActive ? 600 : 500,
                    color: isActive ? '#10B981' : (darkMode ? 'rgba(255,255,255,0.7)' : 'rgba(0,0,0,0.5)'),
                    whiteSpace: 'nowrap',
                }}>
                    {tab.label}
                </span>
            </div>
        );
    };

    return (
        <>
            {/* –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–æ–º –º–µ–Ω—é */}
            {isOpen && (
                <div 
                    onClick={() => setIsOpen(false)}
                    style={{
                        position: 'fixed',
                        inset: 0,
                        backgroundColor: darkMode ? 'rgba(0,0,0,0.3)' : 'rgba(0,0,0,0.1)',
                        zIndex: 190,
                    }}
                />
            )}

            {/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–µ–Ω—é */}
            <div style={{
                position: 'fixed',
                bottom: 'calc(env(safe-area-inset-bottom, 0px) + 0.5rem)',
                left: '0',
                right: '0',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                gap: '0.4rem',
                zIndex: 200,
            }}>
                
                {/* –õ–µ–≤—ã–µ –∫–Ω–æ–ø–∫–∏: –ì–ª–∞–≤–Ω–∞—è, –ö–∞—Ç–∞–ª–æ–≥ */}
                {leftTabs.map((tab, index) => renderTabButton(tab, index, 'left'))}

                {/* –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Å—Ñ–µ—Ä–∞ (–∫–Ω–æ–ø–∫–∞ –º–µ–Ω—é) */}
                <div
                    onClick={() => setIsOpen(!isOpen)}
                    style={{
                        width: '64px',
                        height: '64px',
                        borderRadius: '50%',
                        background: isOpen 
                            ? 'linear-gradient(135deg, #ef4444, #dc2626)'
                            : 'linear-gradient(135deg, #10B981, #059669)',
                        boxShadow: isOpen
                            ? '0 0 30px rgba(239, 68, 68, 0.5), inset 0 0 15px rgba(255,255,255,0.2)'
                            : '0 0 30px rgba(16, 185, 129, 0.5), inset 0 0 15px rgba(255,255,255,0.2)',
                        cursor: 'pointer',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        transition: 'all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55)',
                        transform: isOpen ? 'scale(0.9)' : 'scale(1)',
                        animation: !isOpen ? 'spherePulse 3s ease-in-out infinite' : 'none',
                        flexShrink: 0,
                        position: 'relative',
                    }}
                >
                    <div style={{
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        width: '28px',
                        height: '28px',
                        color: 'white',
                        transition: 'transform 0.3s ease',
                        transform: isOpen ? 'rotate(45deg)' : 'rotate(0deg)',
                    }}>
                        {isOpen ? <XCircle size={28} /> : <Compass size={28} />}
                    </div>

                    {/* –ö–æ–ª—å—Ü–∞ */}
                    {!isOpen && (
                        <>
                            <div style={{
                                position: 'absolute',
                                top: '-6px',
                                left: '-6px',
                                right: '-6px',
                                bottom: '-6px',
                                borderRadius: '50%',
                                border: '2px solid rgba(255,255,255,0.2)',
                                animation: 'ringPulse 2s ease-in-out infinite',
                                pointerEvents: 'none',
                            }} />
                            <div style={{
                                position: 'absolute',
                                top: '-12px',
                                left: '-12px',
                                right: '-12px',
                                bottom: '-12px',
                                borderRadius: '50%',
                                border: '1px solid rgba(255,255,255,0.1)',
                                animation: 'ringPulse 2s ease-in-out infinite 0.5s',
                                pointerEvents: 'none',
                            }} />
                        </>
                    )}
                </div>

                {/* –ü—Ä–∞–≤—ã–µ –∫–Ω–æ–ø–∫–∏: –ü–æ–∏—Å–∫, –ö–∞—Ä—Ç–∞ */}
                {rightTabs.map((tab, index) => renderTabButton(tab, index, 'right'))}
            </div>

            {/* CSS –∞–Ω–∏–º–∞—Ü–∏–∏ */}
            <style>{`
                @keyframes spherePulse {
                    0%, 100% {
                        box-shadow: 0 0 30px rgba(16, 185, 129, 0.5), inset 0 0 15px rgba(255,255,255,0.2);
                    }
                    50% {
                        box-shadow: 0 0 45px rgba(16, 185, 129, 0.7), inset 0 0 20px rgba(255,255,255,0.3);
                    }
                }
                
                @keyframes ringPulse {
                    0%, 100% { transform: scale(1); opacity: 0.3; }
                    50% { transform: scale(1.05); opacity: 0.15; }
                }
            `}</style>
        </>
    );
};

const SearchModal = ({ show, onClose, onNavigate, allRoutes, darkMode, lang }) => {
    const [searchTerm, setSearchTerm] = useState('');
    const [results, setResults] = useState([]);
    const C = darkMode ? S.dark : S.light;
    const t = (k) => TRANSLATIONS[lang]?.[k] || k;

    useEffect(() => { if (!show) { setSearchTerm(''); setResults([]); } }, [show]);

    useEffect(() => {
        if (searchTerm.trim() === '') { setResults([]); return; }
        const term = searchTerm.toLowerCase();
        const filteredRoutes = allRoutes.filter(route =>
            route.name.toLowerCase().includes(term) ||
            (route.descriptionShort && route.descriptionShort.toLowerCase().includes(term))
        );
        setResults(filteredRoutes);
    }, [searchTerm, allRoutes]);

    const handleSelectRoute = (route) => { onNavigate('routeDetails', { route }); onClose(); };

    if (!show) return null;

    const overlayStyle = { position: 'fixed', top: 0, right: 0, bottom: 0, left: 0, backgroundColor: darkMode ? 'rgba(0,0,0,0.9)' : 'rgba(255,255,255,0.95)', display: 'flex', flexDirection: 'column', alignItems: 'center', zIndex: 150, padding: '1rem', paddingTop: '4rem' };
    const modalBoxStyle = { width: '100%', maxWidth: '32rem', color: C.text, height: '100%', display: 'flex', flexDirection: 'column' };
    const inputStyle = { width: '100%', background: C.cardBg, border: 'none', borderRadius: '1rem', padding: '1rem 1.5rem', fontSize: '1.125rem', color: C.text, outline: 'none', boxShadow: '0 4px 12px rgba(0,0,0,0.1)', marginBottom: '1rem' };

    return (
        <div style={overlayStyle}>
            <div style={modalBoxStyle}>
                <div style={{ display: 'flex', gap: '1rem', alignItems: 'center' }}>
                    <input type="text" placeholder={t('search_ph')} style={inputStyle} value={searchTerm} onChange={e => setSearchTerm(e.target.value)} autoFocus />
                    <button onClick={onClose} style={{ background: 'none', border: 'none', color: C.text, fontWeight: 600, cursor: 'pointer' }}>{t('cancel')}</button>
                </div>

                <div style={{ flex: 1, overflowY: 'auto' }}>
                    {results.map(route => (
                        <div key={route.name} onClick={() => handleSelectRoute(route)} style={{ ...S.wFull, padding: '1rem', borderBottom: `1px solid ${C.cardBorder}`, cursor: 'pointer', display: 'flex', gap: '1rem', alignItems: 'center' }}>
                            <img src={route.image} style={{ width: '3rem', height: '3rem', borderRadius: '0.5rem', objectFit: 'cover' }} alt="" />
                            <div>
                                <p style={{ ...S.fontSemibold }}>{route.name}</p>
                                <p style={{ fontSize: '0.8rem', color: C.textMuted }}>{route.subCategory}</p>
                            </div>
                        </div>
                    ))}
                    {searchTerm && results.length === 0 && <p style={{ ...S.p4, ...S.textCenter, color: C.textMuted }}>{t('nothing')}</p>}
                </div>
            </div>
        </div>
    );
};


const RouteDetailsPage = ({ route, darkMode, isFavorite, isCompleted, onBack, onPlayAudio, onToggleFavorite, onMarkCompleted, lang }) => {
    const C = darkMode ? S.dark : S.light;
    const t = (k) => TRANSLATIONS[lang]?.[k] || k;
    const steps = Math.floor(route.distance * 1250);
    const dailyGoal = 10000;
    const percent = Math.round((steps / dailyGoal) * 100);

    return (
        <div style={{ backgroundColor: C.bg, minHeight: '100vh', paddingBottom: '6rem' }}>
            <div style={{ position: 'relative', height: '40vh', width: '100%' }}>
                <img src={route.image} style={{ width: '100%', height: '100%', objectFit: 'cover' }} alt={route.name} />
                <div style={{ position: 'absolute', inset: 0, background: 'linear-gradient(to bottom, rgba(0,0,0,0.3), rgba(0,0,0,0.7))' }} />
                <button onClick={onBack} style={{ position: 'absolute', top: 'calc(env(safe-area-inset-top, 0px) + 1rem)', left: '1rem', background: 'rgba(255,255,255,0.2)', backdropFilter: 'blur(8px)', border: 'none', borderRadius: '50%', width: '40px', height: '40px', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'white', cursor: 'pointer' }}><ArrowLeft /></button>
                <div style={{ position: 'absolute', bottom: '2rem', left: '1.5rem', right: '1.5rem' }}>
                    <div style={{ color: S.emerald600, fontWeight: 700, fontSize: '0.8rem', textTransform: 'uppercase', letterSpacing: '1px', marginBottom: '0.5rem' }}>{t(route.subCategory) || route.subCategory}</div>
                    <h1 style={{ color: 'white', fontSize: '1.75rem', fontWeight: 800, margin: 0, lineHeight: 1.1 }}>{route.name}</h1>
                </div>
            </div>
            <div style={{ position: 'relative', top: '-1.5rem', backgroundColor: C.bg, borderTopLeftRadius: '2rem', borderTopRightRadius: '2rem', padding: '2rem 1.5rem', boxShadow: '0 -10px 30px rgba(0,0,0,0.1)' }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '2rem', backgroundColor: C.cardBg, padding: '1rem', borderRadius: '1rem', border: `1px solid ${C.cardBorder}` }}>
                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', flex: 1 }}> <Navigation size={20} color={S.sky600} style={{ marginBottom: '0.25rem' }} /> <div style={{ fontWeight: 700, color: C.text }}>{route.distance} <span style={{ fontSize: '0.7rem', color: C.textMuted }}>{t('dist')}</span></div> </div>
                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', flex: 1 }}> <Clock size={20} color={S.orange500} style={{ marginBottom: '0.25rem' }} /> <div style={{ fontWeight: 700, color: C.text }}>{route.time.replace("–º–∏–Ω", t("min"))}</div> </div>
                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', flex: 1 }}> <Activity size={20} color={S.emerald600} style={{ marginBottom: '0.25rem' }} /> <div style={{ fontWeight: 700, color: C.text }}>{steps} <span style={{ fontSize: '0.7rem', color: C.textMuted }}>{t('steps')}</span></div> <div style={{ fontSize: '0.65rem', color: S.emerald600, fontWeight: 600 }}>{percent}%</div> </div>
                </div>
                <div style={{ display: 'flex', gap: '0.75rem', marginBottom: '2rem', flexWrap: 'wrap' }}>
                    {route.audioUrl && (<button onClick={() => onPlayAudio(route)} style={{ flex: 1, minWidth: '100px', backgroundColor: S.emerald600, color: 'white', border: 'none', padding: '1rem 0.5rem', borderRadius: '1rem', fontWeight: 600, display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '0.5rem', boxShadow: '0 4px 12px rgba(16, 185, 129, 0.3)', cursor: 'pointer' }}> <PlayCircle size={20} /> {t('audio')} </button>)}
                    {route.videoUrl && (<button onClick={() => window.open(route.videoUrl, '_system')} style={{ flex: 1, minWidth: '100px', backgroundColor: S.red500, color: 'white', border: 'none', padding: '1rem 0.5rem', borderRadius: '1rem', fontWeight: 600, display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '0.5rem', boxShadow: '0 4px 12px rgba(239, 68, 68, 0.3)', cursor: 'pointer' }}> <Clapperboard size={20} /> {t('video')} </button>)}
                    <button onClick={() => window.open(route.geoUrl)} style={{ flex: 1, minWidth: '100px', backgroundColor: C.cardBg, color: C.text, border: `1px solid ${C.cardBorder}`, padding: '1rem 0.5rem', borderRadius: '1rem', fontWeight: 600, display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '0.5rem', cursor: 'pointer' }}> <Navigation size={20} /> {t('map_btn')} </button>
                </div>
                <h3 style={{ fontSize: '1.25rem', fontWeight: 700, color: C.text, marginBottom: '0.75rem' }}>{t('about')}</h3>
                <p style={{ color: C.textMuted, lineHeight: '1.7', fontSize: '1rem', marginBottom: '2rem' }}>{route.descriptionShort}</p>
                <div style={{ display: 'flex', justifyContent: 'space-around', borderTop: `1px solid ${C.cardBorder}`, paddingTop: '1.5rem' }}>
                    <button onClick={() => onToggleFavorite(route)} style={{ background: 'none', border: 'none', display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '0.5rem', color: isFavorite ? S.red500 : C.textMuted, cursor: 'pointer' }}> <Heart fill={isFavorite ? S.red500 : 'none'} /> <span style={{ fontSize: '0.8rem' }}>{t('to_fav')}</span> </button>
                    <button onClick={() => onMarkCompleted(route)} style={{ background: 'none', border: 'none', display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '0.5rem', color: isCompleted ? S.emerald600 : C.textMuted, cursor: 'pointer' }}> <CheckCircle /> <span style={{ fontSize: '0.8rem' }}>{t('visited')}</span> </button>
                </div>
            </div>
        </div>
    );
};

// ... (EditProfileModal, AccountPage, CatalogHeader - no changes needed, keeping compact)
const EditProfileModal = ({ show, onClose, darkMode, account, setAccount, lang }) => { const [newName, setNewName] = useState(account.name); const C = darkMode ? S.dark : S.light; const t = (k) => TRANSLATIONS[lang]?.[k] || k; if (!show) return null; return (<div style={{ position: 'fixed', top: 0, right: 0, bottom: 0, left: 0, backgroundColor: 'rgba(0,0,0,0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 160, padding: '1rem' }} onClick={onClose}> <div style={{ borderRadius: '0.75rem', padding: '1.5rem', width: '100%', maxWidth: '24rem', backgroundColor: C.cardBg, border: `1px solid ${C.cardBorder}`, color: C.text }} onClick={e => e.stopPropagation()}> <h3 style={{ ...S.textXl, ...S.fontBold, marginBottom: '1.5rem', textAlign: 'center' }}>{t('profile')}</h3> <input type="text" value={newName} onChange={(e) => setNewName(e.target.value)} style={{ width: '100%', padding: '0.75rem', borderRadius: '0.5rem', border: `1px solid ${C.cardBorder}`, backgroundColor: C.bg, color: C.text, marginBottom: '1.5rem' }} placeholder="–ò–º—è" /> <div style={{ ...S.flex, gap: '0.5rem' }}> <button onClick={() => { if(newName.trim()) setAccount(prev => ({...prev, name: newName.trim()})); onClose(); }} style={{ flex: 1, backgroundColor: S.emerald600, color: 'white', padding: '0.75rem', borderRadius: '0.75rem', border: 'none' }}>{t('save')}</button> <button onClick={onClose} style={{ flex: 1, backgroundColor: C.cardBorder, color: C.text, padding: '0.75rem', borderRadius: '0.75rem', border: 'none' }}>{t('cancel')}</button> </div> </div> </div>); };
const AccountPage = ({ account, onBack, darkMode, setAccount, lang }) => { const C = darkMode ? S.dark : S.light; const t = (k) => TRANSLATIONS[lang]?.[k] || k; const [showEditModal, setShowEditModal] = useState(false); return (<> <CatalogHeader title={t('profile')} onBack={onBack} darkMode={darkMode} /> <div style={{ ...S.flex, flexDirection: 'column', ...S.itemsCenter, padding: '1.5rem', backgroundColor: C.cardBg, borderRadius: S.roundedXl.borderRadius, border: `1px solid ${C.cardBorder}`, marginBottom: '2rem' }}> <div style={{ width: '6rem', height: '6rem', borderRadius: '50%', backgroundColor: S.emerald600, ...S.flex, ...S.itemsCenter, ...S.justifyCenter, color: 'white', fontSize: '2.5rem' }}><User size={40} /></div> <h3 style={{ ...S.textXl, ...S.fontBold, marginTop: '1rem' }}>{account.name}</h3> <p style={{ color: S.emerald600, ...S.fontSemibold }}>{account.level}</p> <button onClick={() => setShowEditModal(true)} style={{ marginTop: '1rem', backgroundColor: S.sky600, color: 'white', padding: '0.5rem 1rem', borderRadius: '1rem', border: 'none' }}>{t('profile')}</button> </div> <EditProfileModal show={showEditModal} onClose={() => setShowEditModal(false)} darkMode={darkMode} account={account} setAccount={setAccount} lang={lang} /> </>); };
const CatalogHeader = ({ title, onBack, darkMode }) => { const C = darkMode ? S.dark : S.light; return (<div style={{ ...S.flex, ...S.itemsCenter, marginBottom: '1.5rem' }}> <h2 style={{ ...S.textXl, ...S.fontBold, textAlign: 'center', flex: 1 }}>{title}</h2> </div>); };

const RouteListItem = React.memo(({ route, onNavigate, onPlayAudio, onToggleFavorite, isFavorite, userLocation, formatDistance, C, isCompleted, subtitle, lang }) => {
    const distance = userLocation ? calculateDistance(userLocation.lat, userLocation.lon, route.location?.lat, route.location?.lon) : 0;
    const steps = Math.floor(route.distance * 1250);
    const t = (k) => TRANSLATIONS[lang]?.[k] || k;
    return (
        <div onClick={() => onNavigate(route)} style={{ ...cardStyle, backgroundColor: C.cardBg, borderColor: isCompleted ? S.emerald600 : (C.cardBorder || 'transparent'), display: 'flex', gap: '1rem', alignItems: 'center', padding: '0.75rem', boxShadow: C.shadow }}>
            <div style={{ position: 'relative', width: '5rem', height: '5rem', flexShrink: 0 }}> <img src={route.image} alt={route.name} style={{ width: '100%', height: '100%', objectFit: 'cover', borderRadius: '1rem', backgroundColor: C.cardBorder }} /> {route.audioUrl && (<div style={{ position: 'absolute', bottom: '0.25rem', right: '0.25rem', backgroundColor: 'rgba(0,0,0,0.6)', borderRadius: '50%', padding: '0.25rem' }}> <Music size={12} color="white" /> </div>)} </div>
            <div style={{ flex: 1, minWidth: 0 }}> <h3 style={{ ...S.fontSemibold, fontSize: '1rem', lineHeight: '1.3', color: C.text, marginBottom: '0.4rem', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>{route.name}</h3> {subtitle ? (<p style={{ fontSize: '0.8rem', color: S.emerald600, fontWeight: 600 }}>{subtitle}</p>) : (<div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', fontSize: '0.8rem', color: C.textMuted }}> <span style={{ color: S.emerald600, fontWeight: 600 }}>üë£ {steps} <span style={{ color: C.textMuted, fontWeight: 400 }}>({formatDistance(distance)})</span></span> <span><Clock size={12} /> {route.time.replace("–º–∏–Ω", t("min"))}</span> </div>)} </div>
            <div style={{ display: 'flex', alignItems: 'center', flexShrink: 0 }}> {route.audioUrl && (<button onClick={e => { e.stopPropagation(); onPlayAudio(route); }} style={{ background: 'rgba(0,0,0,0.05)', border: 'none', padding: '0.6rem', borderRadius: '50%', color: S.emerald600, marginRight: '0.5rem' }}><PlayCircle size={22} /></button>)} <button onClick={e => { e.stopPropagation(); onToggleFavorite(route); }} style={{ background: 'rgba(0,0,0,0.05)', border: 'none', padding: '0.6rem', borderRadius: '50%', color: isFavorite ? S.red500 : C.textMuted }}><Heart size={22} fill={isFavorite ? S.red500 : 'none'} /></button> </div>
        </div>
    );
});

// --- –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –ö–ê–†–¢–ê (ZOOM FIX) ---
const MapPage = ({ userLocation, allRoutes, completedRoutes, onNavigate, darkMode, centerCity }) => {
    const mapRef = useRef(null);
    const mapInstanceRef = useRef(null);
    // –•—Ä–∞–Ω–∏–º ID –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≥–æ—Ä–æ–¥–∞, —á—Ç–æ–±—ã —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–º–µ–Ω–µ –≥–æ—Ä–æ–¥–∞
    const lastCityIdRef = useRef(null);

    useEffect(() => {
        if (!document.getElementById('leaflet-css')) { const link = document.createElement('link'); link.id = 'leaflet-css'; link.rel = 'stylesheet'; link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css'; document.head.appendChild(link); }
        if (!document.getElementById('leaflet-js')) { const script = document.createElement('script'); script.id = 'leaflet-js'; script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js'; script.async = true; script.onload = () => initMap(); document.body.appendChild(script); } else { initMap(); }
        return () => { if (mapInstanceRef.current) { mapInstanceRef.current.remove(); mapInstanceRef.current = null; } };
    }, []);

    const initMap = () => {
        if (!window.L || mapInstanceRef.current) return;
        const startLat = centerCity ? centerCity.lat : (userLocation ? userLocation.lat : 55.354);
        const startLon = centerCity ? centerCity.lon : (userLocation ? userLocation.lon : 86.087);
        
        const map = window.L.map(mapRef.current, { center: [startLat, startLon], zoom: 13, zoomControl: false });
        window.L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '&copy; OpenStreetMap' }).addTo(map);
        mapInstanceRef.current = map;
        lastCityIdRef.current = centerCity ? centerCity.id : null;
        updateMarkers(map);
    };

    useEffect(() => {
        if (window.L && mapInstanceRef.current) {
            // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∫–∞—Ä—Ç—É –¢–û–õ–¨–ö–û –µ—Å–ª–∏ —Å–º–µ–Ω–∏–ª—Å—è –≥–æ—Ä–æ–¥
            if (centerCity && centerCity.id !== lastCityIdRef.current) {
                mapInstanceRef.current.setView([centerCity.lat, centerCity.lon], 13);
                lastCityIdRef.current = centerCity.id;
            }
            
            mapInstanceRef.current.eachLayer((layer) => { if (layer instanceof window.L.Marker) { mapInstanceRef.current.removeLayer(layer); } });
            updateMarkers(mapInstanceRef.current);
        }
    }, [userLocation, allRoutes, completedRoutes, centerCity]);

    const updateMarkers = (map) => {
        const L = window.L;
        if (userLocation) {
            const userIcon = L.divIcon({ className: 'custom-icon', html: `<div style="background-color: #2563eb; width: 16px; height: 16px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 10px rgba(0,0,0,0.3);"></div>`, iconSize: [16, 16], iconAnchor: [8, 8] });
            L.marker([userLocation.lat, userLocation.lon], { icon: userIcon }).addTo(map);
        }
        allRoutes.forEach(route => {
            if (!route.location) return;
            const isCompleted = completedRoutes.some(c => c.name === route.name);
            const style = getCategoryStyle(route.subCategory);
            const color = isCompleted ? '#059669' : '#3b82f6';
            const iconHtml = `<div style="background-color: ${color}; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">${style.svgString}</div>`;
            const routeIcon = L.divIcon({ className: 'route-icon', html: iconHtml, iconSize: [36, 36], iconAnchor: [18, 18], popupAnchor: [0, -18] });
            const marker = L.marker([route.location.lat, route.location.lon], { icon: routeIcon }).addTo(map);
            marker.on('click', () => onNavigate(route));
        });
    };
    return <div ref={mapRef} style={{ width: '100%', height: 'calc(100vh - 5rem)', zIndex: 1 }} />;
};

const RecommendationTile = ({ route, onClick, C, formatDistance, userLocation, lang }) => {
    const distance = userLocation ? calculateDistance(userLocation.lat, userLocation.lon, route.location?.lat, route.location?.lon) : 0;
    const steps = Math.floor(route.distance * 1250);
    const t = (k) => TRANSLATIONS[lang]?.[k] || k;
    
    return (
        <div onClick={() => onClick(route)} style={{ 
            minWidth: '38%',
            height: '9.5rem',
            borderRadius: '1rem',
            position: 'relative', 
            overflow: 'hidden', 
            cursor: 'pointer', 
            boxShadow: C.cardShadow, 
            border: `1px solid ${C.border}`,
            flexShrink: 0,
        }}>
            <img src={route.image} alt={route.name} style={{ width: '100%', height: '100%', objectFit: 'cover' }} />
            <div style={{ 
                position: 'absolute', 
                bottom: 0, 
                left: 0, 
                right: 0, 
                background: 'linear-gradient(to top, rgba(0,0,0,0.85), transparent)', 
                padding: '0.5rem 0.6rem 0.5rem 0.6rem',
                display: 'flex', 
                flexDirection: 'column', 
                justifyContent: 'flex-end' 
            }}>
                <div style={{ 
                    color: '#10B981', 
                    fontWeight: 600, 
                    fontSize: '0.6rem', 
                    textTransform: 'uppercase', 
                    marginBottom: '0.15rem',
                    lineHeight: 1.1,
                }}>{t(route.subCategory)}</div>
                <h3 style={{ 
                    color: 'white', 
                    fontWeight: 700, 
                    fontSize: '0.85rem', 
                    margin: '0 0 0.2rem 0', 
                    lineHeight: 1.15, 
                    display: '-webkit-box', 
                    WebkitLineClamp: 2, 
                    WebkitBoxOrient: 'vertical', 
                    overflow: 'hidden' 
                }}>{route.name}</h3>
                <div style={{ 
                    display: 'flex', 
                    alignItems: 'center', 
                    gap: '0.4rem', 
                    color: 'rgba(255,255,255,0.85)', 
                    fontSize: '0.7rem', 
                    fontWeight: 500 
                }}>
                    <span>üë£ {steps}</span>
                </div>
            </div>
        </div>
    );
};

function MainRouteApp({ onExit, setAccount, ...props }) {
    const { favoriteRoutes, completedRoutes, handleRouteCompletionGlobal, isRouteInFavorites, toggleFavorite, account, darkMode, setDarkMode, units, setUnits, routeIcons, buildInfo, setShowContactModal, currentLang, setCurrentLang, currentCity, setCurrentCity } = props;
    const [navigationStack, setNavigationStack] = useState([{ type: 'home' }]);
    const [showModal, setShowModal] = useState(false);
    const [modalMessage, setModalMessage] = useState("");
    const [settingsOpen, setSettingsOpen] = useState(false);
    const [currentPlayingRoute, setCurrentPlayingRoute] = useState(null);
    const [activeTab, setActiveTab] = useState('recommendations');
    const [showSearchModal, setShowSearchModal] = useState(false);
    const [userLocation, setUserLocation] = useState(null);
    const [showLangModal, setShowLangModal] = useState(false);
    const [showCityModal, setShowCityModal] = useState(false);
    const [notifiedRoutes, setNotifiedRoutes] = useState(new Set());
    const [appNotifications, setAppNotifications] = useState([]);
    const [showNotifPermissionModal, setShowNotifPermissionModal] = useState(false);
    const activeRoutes = useMemo(() => getRoutesData(currentCity, currentLang), [currentCity, currentLang]);
    const audioPlayerRef = useRef(null);
    const settingsRef = useRef(null);
    const C = darkMode ? S.dark : S.light;
    const currentView = navigationStack[navigationStack.length - 1];
    const t = (k) => TRANSLATIONS[currentLang]?.[k] || k;

    useEffect(() => {
        const handleSystemChecks = async () => {
            try {
                const response = await fetch(VERSION_CHECK_URL);
                if (response.ok) {
                    const data = await response.json();
                    if (parseFloat(data.version) > parseFloat(buildInfo.version)) {
                        setAppNotifications(prev => { if (prev.find(n => n.type === 'update')) return prev; return [...prev, { id: 'update', type: 'update', title: '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ', text: `–î–æ—Å—Ç—É–ø–Ω–∞ –≤–µ—Ä—Å–∏—è ${data.version}.`, actionUrl: RUSTORE_LINK }]; });
                    }
                }
            } catch (e) { }
        };
        handleSystemChecks();
    }, []);

    const allRoutesFlatForSearch = useMemo(() => { return Object.values(activeRoutes).flatMap(cat => Object.values(cat).flat()); }, [activeRoutes]);
    const uniqueAllRoutes = useMemo(() => { const unique = new Map(); 
        
        allRoutesFlatForSearch.forEach(r => { if (!unique.has(r.name)) unique.set(r.name, r); }); return Array.from(unique.values()); }, [allRoutesFlatForSearch]);
// –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
// –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
useEffect(() => {
    const checkPermissions = async () => {
        const result = await LocalNotifications.checkPermissions();
        
        // –ï—Å–ª–∏ —É–∂–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
        if (result.display === 'granted') return;
        
        // –ï—Å–ª–∏ –∑–∞–ø—Ä–µ—â–µ–Ω–æ –∏–ª–∏ –Ω–µ —Å–ø—Ä–∞—à–∏–≤–∞–ª–∏ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            setShowNotifPermissionModal(true);
        }, 3000);
    };
    checkPermissions();
}, []);

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–¥–∞–ª–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
const handleAllowNotifications = async () => {
    setShowNotifPermissionModal(false);
    const result = await LocalNotifications.requestPermissions();
    if (result.display === 'granted') {
        setModalMessage(t('notif_permission_title') + ' ‚úÖ');
        setShowModal(true);
    }
};

const handleLaterNotifications = () => {
    setShowNotifPermissionModal(false);
    // –ó–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ª–æ–∂–∏–ª (–º–æ–∂–Ω–æ —Å–ø—Ä–æ—Å–∏—Ç—å —á–µ—Ä–µ–∑ –¥–µ–Ω—å)
    localStorage.setItem('notifPermissionAskedAt', Date.now());
};
    useEffect(() => {
    const geoSuccess = (position) => {
        const lat = position.coords.latitude; 
        const lon = position.coords.longitude; 
        setUserLocation({ lat, lon });
        
        // –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã –≤ —Ä–∞–¥–∏—É—Å–µ 150–º –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –±–ª–∏–∑–æ—Å—Ç–∏
const nearbyRoutes = allRoutesFlatForSearch
    .filter(route => {
        if (!route.location) return false;
        if (notifiedRoutes.has(route.name)) return false; // —É–∂–µ —É–≤–µ–¥–æ–º–ª—è–ª–∏
        
        const distanceKm = calculateDistance(lat, lon, route.location.lat, route.location.lon);
        const distanceMeters = distanceKm * 1000;
        return distanceMeters <= 150;
    })
    .map(route => {
        const distanceKm = calculateDistance(lat, lon, route.location.lat, route.location.lon);
        return {
            ...route,
            distanceMeters: Math.round(distanceKm * 1000)
        };
    })
    .sort((a, b) => a.distanceMeters - b.distanceMeters); // —Å–æ—Ä—Ç–∏—Ä—É–µ–º: –±–ª–∏–∂–∞–π—à–∏–π –ø–µ—Ä–≤—ã–π

// –£–≤–µ–¥–æ–º–ª—è–µ–º —Ç–æ–ª—å–∫–æ –æ –ë–õ–ò–ñ–ê–ô–®–ï–ú –º–∞—Ä—à—Ä—É—Ç–µ (–Ω–µ —á–∞—â–µ —Ä–∞–∑ –≤ 5 –º–∏–Ω—É—Ç)
if (nearbyRoutes.length > 0) {
    const lastNotifTime = parseInt(localStorage.getItem('lastRouteNotification') || '0');
    const now = Date.now();
    const timeSinceLastNotif = now - lastNotifTime;
    const minInterval = 5 * 60 * 1000; // 5 –º–∏–Ω—É—Ç
    
    if (timeSinceLastNotif >= minInterval) {
        const closestRoute = nearbyRoutes[0]; // –±–µ—Ä—ë–º —Å–∞–º—ã–π –±–ª–∏–∑–∫–∏–π
        
        LocalNotifications.schedule({ 
            notifications: [{ 
                title: "–†—è–¥–æ–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç! üéß", 
                body: `${closestRoute.name} (${closestRoute.distanceMeters} –º)\n–ü–æ—Å–ª—É—à–∞—Ç—å –∞—É–¥–∏–æ–≥–∏–¥?`, 
                id: Math.floor(Math.random() * 100000), 
                schedule: { at: new Date(Date.now() + 100) },
                sound: 'default',
                extra: { 
                    routeId: closestRoute.name,
                    routeData: JSON.stringify(closestRoute)
                } 
            }] 
        });
        
        setNotifiedRoutes(prev => new Set(prev).add(closestRoute.name));
        localStorage.setItem('lastRouteNotification', now.toString());
    }
}
    };

    const geoError = () => setUserLocation(CITIES.find(c => c.id === currentCity)); 
    
    let watchId; 
    if (navigator.geolocation) { 
        watchId = navigator.geolocation.watchPosition(geoSuccess, geoError, { 
            enableHighAccuracy: true,
            maximumAge: 10000, // –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫
            timeout: 5000
        }); 
    } else { 
        geoError(); 
    }
    
    return () => { 
        if (watchId) navigator.geolocation.clearWatch(watchId); 
    };
}, 
  [allRoutesFlatForSearch, notifiedRoutes, currentCity]);

    const allRoutesFlat = useMemo(() => { return Object.keys(activeRoutes).flatMap(topCat => Object.keys(activeRoutes[topCat]).flatMap(subCat => activeRoutes[topCat][subCat])); }, [activeRoutes]);

    const recommendedRoutes = useMemo(() => {
        if (!userLocation || !allRoutesFlat.length) return [];
        const uniqueRoutes = new Map();
        allRoutesFlat.forEach(route => { if (!uniqueRoutes.has(route.name)) { uniqueRoutes.set(route.name, { ...route, calculatedDistance: calculateDistance(userLocation.lat, userLocation.lon, route.location?.lat, route.location?.lon) }); } });
        return Array.from(uniqueRoutes.values()).sort((a, b) => a.calculatedDistance - b.calculatedDistance).slice(0, 5);
    }, [userLocation, allRoutesFlat]);
    // --- –ó–ê–ú–ï–ù–ê: –í–º–µ—Å—Ç–æ newestRoutes –¥–µ–ª–∞–µ–º promoRoutes ---
        // –†–ï–ö–õ–ê–ú–ê (–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–∑ –æ–±—â–µ–≥–æ —Å–ø–∏—Å–∫–∞)
    const promoRoutes = useMemo(() => {
        // –ò—â–µ–º –º–∞—Ä—à—Ä—É—Ç—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö –∏–º—è "
        return allRoutesFlat.filter(route => 
            route.name === "–õ—É—á—à–µ–µ –ö–∞—Ñ–µ - –ü–∞—Ä–∞–¥–Ω–∞—è"
        );
    }, [allRoutesFlat]);
// –†–ê–ó–î–ï–õ "–ò–°–°–õ–ï–î–£–ô" (4 —Ä–∞–Ω–¥–æ–º–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–∞ + 1 –≤—Ä—É—á–Ω—É—é)
// –†–ê–ó–î–ï–õ "–ò–°–°–õ–ï–î–£–ô" (–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å–º–µ–Ω–µ –≥–æ—Ä–æ–¥–∞/—Å–ø–∏—Å–∫–∞)
const exploreRoutes = useMemo(() => {
    const manualRoute = allRoutesFlat.find(r => r.name === "5 —Ñ–∞–∫—Ç–æ–≤ –æ –ö–µ–º–µ—Ä–æ–≤–æ, –æ –∫–æ—Ç–æ—Ä—ã—Ö —Ç—ã –Ω–µ –∑–Ω–∞–ª");
    
    // –ú–´ –£–ë–†–ê–õ–ò recommendedRoutes –ò–ó –≠–¢–û–ì–û –°–ü–ò–°–ö–ê
    // –¢–µ–ø–µ—Ä—å –º–∞—Ä—à—Ä—É—Ç—ã –∑–¥–µ—Å—å –Ω–µ –±—É–¥—É—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç —Ç–æ–≥–æ, —á—Ç–æ —Å–µ–π—á–∞—Å –≤ —Ä–∞–∑–¥–µ–ª–µ "–†—è–¥–æ–º"
    const excludedNames = new Set([
        ...promoRoutes.map(r => r.name), 
        manualRoute?.name
    ].filter(Boolean));
    
    const uniqueRoutes = new Map();
    allRoutesFlat
        .filter(route => !excludedNames.has(route.name))
        .forEach(route => {
            if (!uniqueRoutes.has(route.name)) {
                uniqueRoutes.set(route.name, route);
            }
        });
    
    const availableRoutes = Array.from(uniqueRoutes.values());
    // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (—Ä–∞–Ω–¥–æ–º) —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
    const shuffled = availableRoutes.sort(() => Math.random() - 0.5);
    const randomRoutes = shuffled.slice(0, 3);
    
    return manualRoute 
        ? [manualRoute, ...randomRoutes] 
        : randomRoutes.slice(0, 4);

// –í–ê–ñ–ù–û: –£–±—Ä–∞–ª recommendedRoutes –∏–∑ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —Å–∫–æ–±–æ–∫ –≤–Ω–∏–∑—É
}, [currentCity, allRoutesFlat, promoRoutes]);
// –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
useEffect(() => {
    let listener = null;
    
    const setupListener = async () => {
        try {
            listener = await LocalNotifications.addListener('localNotificationActionPerformed', (notification) => {
                const routeData = notification.notification.extra?.routeData;
                if (routeData) {
                    try {
                        const route = JSON.parse(routeData);
                        navigate('routeDetails', { route });
                        setActiveTab('recommendations');
                    } catch (e) {
                        console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –º–∞—Ä—à—Ä—É—Ç–∞ –∏–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:', e);
                    }
                }
            });
        } catch (e) {
            console.log('Notification listener not available');
        }
    };
    
    setupListener();
    
    return () => {
        if (listener && typeof listener.remove === 'function') {
            listener.remove();
        }
    };
}, []);

    const stopAudio = useCallback(() => { if (audioPlayerRef.current) { audioPlayerRef.current.pause(); } setCurrentPlayingRoute(null); }, []);
    const goBack = useCallback(() => { setNavigationStack(prev => (prev.length > 1 ? prev.slice(0, -1) : prev)); }, []);
    const navigate = useCallback((type, data = {}) => { if (type === 'routeDetails') { stopAudio(); } setNavigationStack(prev => [...prev, { type, ...data }]); }, [stopAudio]);
    const playAudio = useCallback((route) => { if (route && route.audioUrl) { setCurrentPlayingRoute(route); } else { setModalMessage("–ù–µ—Ç –∞—É–¥–∏–æ–≥–∏–¥–∞"); setShowModal(true); } }, []);
    const handleTabChange = useCallback((tabId) => { setActiveTab(tabId); if (tabId === 'catalog') { setNavigationStack([{ type: 'categories' }]); } else { setNavigationStack([{ type: 'home' }]); } }, []);

    useEffect(() => { 
    let listener = null;
    
    const setupListener = async () => {
        try {
            listener = await CapacitorApp.addListener('backButton', () => { 
                if (navigationStack.length > 1) { 
                    goBack(); 
                    return; 
                } 
                onExit(); 
            });
        } catch (e) {
            console.log('BackButton listener not available');
        }
    };
    
    setupListener();
    
    return () => { 
        if (listener && typeof listener.remove === 'function') {
            listener.remove(); 
        }
    }; 
}, [navigationStack.length, goBack, onExit]);
    useEffect(() => { const handleClickOutside = (event) => { if (settingsRef.current && !settingsRef.current.contains(event.target)) { setSettingsOpen(false); } }; if (settingsOpen) { document.addEventListener("mousedown", handleClickOutside); } return () => { document.removeEventListener("mousedown", handleClickOutside); }; }, [settingsOpen]);
    const formatDistance = useCallback(km => units === 'mi' ? `${(km * 0.621371).toFixed(2)} mi` : `${km.toFixed(2)} ${t('dist')}`, [units, currentLang]);

    const settingsItems = [
        { label: t('completed'), action: () => { navigate('progress'); setSettingsOpen(false); }, icon: <CheckCircle style={{ width: '1.25rem', height: '1.25rem', marginRight: '0.75rem' }} /> },
    { label: t('fav'), action: () => { setActiveTab('favorites'); navigate('favorites'); setSettingsOpen(false); }, icon: <Star style={{ width: '1.25rem', height: '1.25rem', marginRight: '0.75rem' }} /> },
    { label: t('account'), action: () => { navigate('account'); setSettingsOpen(false); }, icon: <User style={{ width: '1.25rem', height: '1.25rem', marginRight: '0.75rem' }} /> },
{ label: t('contact'), action: () => { setShowContactModal(true); setSettingsOpen(false); }, icon: <Mail style={{ width: '1.25rem', height: '1.25rem', marginRight: '0.75rem' }} /> },
        { label: t('notif'), action: () => { setActiveTab('notifications'); navigate('notifications'); setSettingsOpen(false); }, icon: <Bell style={{ width: '1.25rem', height: '1.25rem', marginRight: '0.75rem' }} /> },
        { type: 'divider' },
        { label: t('city'), action: () => { setShowCityModal(true); setSettingsOpen(false); }, icon: <Building style={{ width: '1.25rem', height: '1.25rem', marginRight: '0.75rem' }} /> },
        { label: t('lang'), action: () => { setShowLangModal(true); setSettingsOpen(false); }, icon: <Globe style={{ width: '1.25rem', height: '1.25rem', marginRight: '0.75rem' }} /> },
        { label: darkMode ? t('theme_light') : t('theme_dark'), action: () => { setDarkMode(!darkMode); setSettingsOpen(false); }, icon: darkMode ? <Sun style={{ width: '1.25rem', height: '1.25rem', marginRight: '0.75rem' }} /> : <Moon style={{ width: '1.25rem', height: '1.25rem', marginRight: '0.75rem' }} /> },
        { label: t('exit'), action: onExit, icon: <LogOut style={{ width: '1.25rem', height: '1.25rem', marginRight: '0.75rem' }} /> },
        { type: 'divider' },
        { label: `–í–µ—Ä—Å–∏—è —Å–±–æ—Ä–∫–∏ ${buildInfo.version}`, action: () => {}, icon: <Info style={{ width: '1.25rem', height: '1.25rem', marginRight: '0.75rem' }} /> }
    ];

    const handleNavigateToDetails = useCallback((route) => { navigate('routeDetails', { route }); }, [navigate]);
    const renderCurrentView = () => {
    if (!currentView) return null;
    if (currentView.type === 'favorites') {
    const currentCityFavorites = favoriteRoutes.filter(r => r.cityId === currentCity || (!r.cityId && currentCity === 'kemerovo'));
    return (
        <div>
            <CatalogHeader title={t('fav')} onBack={goBack} darkMode={darkMode} />
            {currentCityFavorites.length > 0 ? (
                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>
                    {currentCityFavorites.map((route) => (
                        <RouteListItem 
                            key={route.name} 
                            route={route} 
                            onNavigate={handleNavigateToDetails} 
                            onPlayAudio={playAudio} 
                            onToggleFavorite={toggleFavorite} 
                            isFavorite={true} 
                            isCompleted={completedRoutes.some(c => c.name === route.name)} 
                            userLocation={userLocation} 
                            formatDistance={formatDistance} 
                            C={C} 
                            lang={currentLang} 
                        />
                    ))}
                </div>
            ) : (
                <div style={{ ...cardStyle, backgroundColor: C.cardBg, borderColor: C.cardBorder, ...S.textCenter, padding: '3rem 1rem' }}>
                    <p style={{ color: C.text, fontWeight: 600 }}>{t('empty_list')}</p>
                </div>
            )}
        </div>
    );
}
    if (currentView.type === 'routeDetails') {
        return <RouteDetailsPage route={currentView.route} darkMode={darkMode} isFavorite={isRouteInFavorites(currentView.route)} isCompleted={completedRoutes.some(c => c.name === currentView.route.name)} onBack={goBack} onPlayAudio={playAudio} onToggleFavorite={toggleFavorite} onMarkCompleted={handleRouteCompletionGlobal} lang={currentLang} />;
    }
    if (currentView.type === 'account') { 
        return <AccountPage account={account} onBack={goBack} darkMode={darkMode} setAccount={setAccount} lang={currentLang} />; 
    }
    if (currentView.type === 'progress') {
        return (<div> <CatalogHeader title={t('completed')} onBack={goBack} darkMode={darkMode} /> {completedRoutes.length > 0 ? (<div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}> {completedRoutes.map((route, idx) => (<RouteListItem key={`comp-${idx}`} route={route} onNavigate={handleNavigateToDetails} onPlayAudio={playAudio} onToggleFavorite={toggleFavorite} isFavorite={isRouteInFavorites(route)} isCompleted={true} userLocation={userLocation} formatDistance={formatDistance} C={C} subtitle={`${t('visited')}: ${route.date}`} lang={currentLang} />))} </div>) : (<div style={{ ...cardStyle, backgroundColor: C.cardBg, borderColor: C.cardBorder, ...S.textCenter, padding: '2rem' }}> <p style={{ color: C.text }}>{t('empty_list')}</p> </div>)} </div>);
    }
    if (currentView.type === 'notifications') { 
        return (<div> <CatalogHeader title={t('notif')} onBack={goBack} darkMode={darkMode} /> <div style={{ ...cardStyle, backgroundColor: C.cardBg, borderColor: C.cardBorder, ...S.textCenter, padding: '3rem 1rem' }}> <p style={{ color: C.text, fontWeight: 600 }}>{appNotifications.length > 0 ? appNotifications[0].text : t('empty_list')}</p> </div> </div>); 
    }

    switch (activeTab) {
        case 'catalog': {
            const catalogTitle = currentView.type === 'subCategories' ? t(currentView.category) : currentView.type === 'subRoutes' ? t(currentView.subCategory) : t('cat');
            return (<> <CatalogHeader title={catalogTitle} onBack={currentView.type !== 'categories' ? goBack : null} darkMode={darkMode} />
                {currentView.type === 'categories' && (
                    <div style={{ display: 'grid', gap: '0.75rem', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))' }}>
                        {Object.keys(CATALOG_STRUCTURE).map(key => {
                            const categoryData = activeRoutes[key];
                            const isActive = categoryData && isCategoryActive(categoryData);
                            return (
                                <button key={key} onClick={() => isActive && navigate('subCategories', { category: key })} style={{ ...cardStyle, backgroundColor: C.cardBg, borderColor: C.cardBorder, ...S.flex, ...S.justifyBetween, ...S.itemsCenter, opacity: isActive ? 1 : 0.5, padding: '1.25rem', cursor: isActive ? 'pointer' : 'default' }} disabled={!isActive}>
                                    <div style={{ ...S.flex, ...S.itemsCenter, gap: '1rem' }}> {routeIcons[key] || <MapPin style={{ width: '1.5rem', height: '1.5rem', color: S.emerald600 }} />} <span style={{ ...S.fontSemibold, color: C.text, fontSize: '1rem' }}>{t(key)}</span> </div>
                                    {isActive && <ChevronRight style={{ width: '1.25rem', height: '1.25rem', color: C.textMuted }} />}
                                </button>
                            )
                        })}
                    </div>
                )}
                {currentView.type === 'subCategories' && (
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
                        {CATALOG_STRUCTURE[currentView.category].map(subCatKey => {
                            const routesInSubCat = activeRoutes[currentView.category]?.[subCatKey] || [];
                            const isActive = routesInSubCat.length > 0;
                            const style = getCategoryStyle(subCatKey);
                            return (
                                <button key={subCatKey} onClick={() => isActive && navigate('subRoutes', { category: currentView.category, subCategory: subCatKey })} style={{ ...cardStyle, backgroundColor: C.cardBg, borderColor: C.cardBorder, ...S.flex, ...S.justifyBetween, ...S.itemsCenter, opacity: isActive ? 1 : 0.5, padding: '1rem', cursor: isActive ? 'pointer' : 'default' }} disabled={!isActive}>
                                    <div style={{ ...S.flex, ...S.itemsCenter, gap: '1rem' }}> {style.iconComp} <span style={{ ...S.fontSemibold, color: C.text, fontSize: '1rem' }}>{t(subCatKey)}</span> </div>
                                    {isActive && <ChevronRight style={{ width: '1.25rem', height: '1.25rem', color: C.textMuted }} />}
                                </button>
                            )
                        })}
                    </div>
                )}
                {currentView.type === 'subRoutes' && (<div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}> {(activeRoutes[currentView.category]?.[currentView.subCategory] || []).map((route) => (<RouteListItem key={route.name} route={route} onNavigate={handleNavigateToDetails} onPlayAudio={playAudio} onToggleFavorite={toggleFavorite} isFavorite={isRouteInFavorites(route)} isCompleted={completedRoutes.some(c => c.name === route.name)} userLocation={userLocation} formatDistance={formatDistance} C={C} lang={currentLang} />))} </div>)} </>);
        }
        
              case 'recommendations': {
    const cityName = t('city_' + currentCity) || CITIES.find(c => c.id === currentCity)?.name || "City";
    return (
        <div>
            <h1 style={{ fontSize: '1.5rem', fontWeight: 800, color: C.text, marginBottom: '0.75rem', marginTop: '0.25rem' }}> 
                <span style={{ color: S.emerald600 }}>{t('app_name')}</span> {cityName} 
            </h1>
            
            {/* 1. –ë–õ–û–ö "–†–Ø–î–û–ú –° –í–ê–ú–ò" */}
            {recommendedRoutes.length > 0 && (
                <div style={{ marginBottom: '1rem' }}> 
                    <h2 style={{ fontSize: '1.1rem', fontWeight: 700, marginBottom: '0.5rem', color: C.text }}>{t('near')}</h2> 
                    <div style={{ display: 'flex', gap: '0.6rem', overflowX: 'auto', paddingBottom: '0.5rem', scrollbarWidth: 'none' }}> 
                        {recommendedRoutes.map((route, idx) => (
                            <RecommendationTile key={`rec-${idx}`} route={route} onClick={handleNavigateToDetails} formatDistance={formatDistance} userLocation={userLocation} C={C} lang={currentLang} />
                        ))} 
                    </div> 
                </div>
            )}
            
            {/* 2. –ë–õ–û–ö "–†–ï–ö–õ–ê–ú–ê" */}
            {promoRoutes.length > 0 && (
                <div style={{ marginBottom: '1rem' }}> 
                    <h2 style={{ fontSize: '1.1rem', fontWeight: 700, marginBottom: '0.5rem', color: C.text }}>{t('ads') || "–†–µ–∫–ª–∞–º–∞"}</h2> 
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}> 
                        {promoRoutes.map((route, idx) => (
                            <RouteListItem key={`promo-${idx}`} route={route} onNavigate={handleNavigateToDetails} onPlayAudio={playAudio} onToggleFavorite={toggleFavorite} isFavorite={isRouteInFavorites(route)} isCompleted={completedRoutes.some(c => c.name === route.name)} userLocation={userLocation} formatDistance={formatDistance} C={C} lang={currentLang} />
                        ))} 
                    </div> 
                </div>
            )}

            {/* 3. –ë–õ–û–ö "–ò–°–°–õ–ï–î–£–ô" */}
            {exploreRoutes.length > 0 && (
                <div style={{ marginBottom: '1rem' }}> 
                    <h2 style={{ fontSize: '1.1rem', fontWeight: 700, marginBottom: '0.5rem', color: C.text }}>üîç –ò—Å—Å–ª–µ–¥—É–π</h2> 
                    <div style={{ display: 'flex', gap: '0.6rem', overflowX: 'auto', paddingBottom: '0.5rem', scrollbarWidth: 'none' }}> 
                        {exploreRoutes.map((route, idx) => (
                            <RecommendationTile key={`explore-${idx}`} route={route} onClick={handleNavigateToDetails} formatDistance={formatDistance} userLocation={userLocation} C={C} lang={currentLang} />
                        ))} 
                    </div> 
                </div>
            )}
        </div>
    );
}
        
        case 'favorites': {
            const currentCityFavorites = favoriteRoutes.filter(r => r.cityId === currentCity || (!r.cityId && currentCity === 'kemerovo'));
            return (<div> <CatalogHeader title={t('fav')} onBack={null} darkMode={darkMode} /> {currentCityFavorites.length > 0 ? (<div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}> {currentCityFavorites.map((route) => (<RouteListItem key={route.name} route={route} onNavigate={handleNavigateToDetails} onPlayAudio={playAudio} onToggleFavorite={toggleFavorite} isFavorite={true} isCompleted={completedRoutes.some(c => c.name === route.name)} userLocation={userLocation} formatDistance={formatDistance} C={C} lang={currentLang} />))} </div>) : (<div style={{ ...cardStyle, backgroundColor: C.cardBg, borderColor: C.cardBorder, ...S.textCenter, padding: '3rem 1rem' }}> <p style={{ color: C.text, fontWeight: 600 }}>{t('empty_list')}</p> </div>)} </div>);
        }
        
        case 'map': { 
            const center = CITIES.find(c => c.id === currentCity); 
            return (<div style={{ width: '100%', height: '100%', position: 'absolute', top: 0, left: 0, zIndex: 1 }}> <MapPage userLocation={userLocation} allRoutes={allRoutesFlat} completedRoutes={completedRoutes} onNavigate={handleNavigateToDetails} darkMode={darkMode} centerCity={center} /> </div>); 
        }
        
        default: 
            return null;
    }
};
    const isMapTab = activeTab === 'map';
    const containerStyle = isMapTab ? { width: '100%', height: '100vh', backgroundColor: C.bg, overflow: 'hidden' } : { width: '100%', padding: '1rem 1rem calc(5.5rem + env(safe-area-inset-bottom, 0px)) 1rem', paddingTop: 'calc(env(safe-area-inset-top, 0px) + 1rem)', backgroundColor: C.bg, color: C.text, boxSizing: 'border-box', overflowY: 'auto', minHeight: '100vh' };

    return (<> <div style={containerStyle}>
        {!isMapTab && (<div ref={settingsRef} style={{ position: 'absolute', top: 'calc(env(safe-area-inset-top, 0px) + 0.5rem)', right: '1rem', zIndex: 110 }}> <button onClick={() => setSettingsOpen(!settingsOpen)} style={{ cursor: 'pointer', padding: '0.5rem', borderRadius: '9999px', color: C.textMuted, backgroundColor: C.cardBg, border: `1px solid ${C.cardBorder}`, position: 'relative' }}> <Settings style={{ width: '1.25rem', height: '1.25rem', color: C.text }} /> </button> {settingsOpen && (<div style={{ position: 'absolute', top: '3rem', right: 0, width: '16rem', boxShadow: '0 10px 25px -5px rgba(0, 0, 0, 0.1)', borderRadius: '1rem', padding: '0.5rem', zIndex: 20, border: `1px solid ${C.cardBorder}`, backgroundColor: C.cardBg }}> {settingsItems.map((item, index) => { if (item.type === 'divider') return <hr key={`div-${index}`} style={{ border: 'none', borderTop: `1px solid ${C.cardBorder}`, margin: '0.5rem 0' }} />; return <button key={item.label} onClick={item.action} style={{ width: '100%', display: 'flex', alignItems: 'center', textAlign: 'left', padding: '0.75rem', borderRadius: '0.5rem', background: 'none', border: 'none', cursor: 'pointer', color: C.text, transition: 'background 0.2s' }}>{item.icon}<span>{item.label}</span></button>; })} </div>)} </div>)} {renderCurrentView()} </div>
        <Modal show={showModal} message={modalMessage} onClose={() => setShowModal(false)} darkMode={darkMode} lang={currentLang} />
        <SelectionModal show={showCityModal} onClose={() => setShowCityModal(false)} title={t('city')} items={CITIES} onSelect={setCurrentCity} currentId={currentCity} darkMode={darkMode} lang={currentLang} />
        <SelectionModal show={showLangModal} onClose={() => setShowLangModal(false)} title={t('lang')} items={LANGUAGES} onSelect={setCurrentLang} currentId={currentLang} darkMode={darkMode} lang={currentLang} />
        <SearchModal show={showSearchModal} onClose={() => setShowSearchModal(false)} onNavigate={navigate} allRoutes={uniqueAllRoutes} darkMode={darkMode} lang={currentLang} />
        {currentPlayingRoute && <MiniAudioPlayer route={currentPlayingRoute} onClose={stopAudio} darkMode={darkMode} ref={audioPlayerRef} onAudioError={() => { stopAudio(); setModalMessage(t('audio_error')); setShowModal(true); }} />} 
            <LiquidMenu activeTab={activeTab} onTabChange={handleTabChange} onSearchClick={() => setShowSearchModal(true)} darkMode={darkMode} lang={currentLang} />     </>);
}

const LoadingScreen = ({ darkMode, onComplete }) => {
    const [showHint, setShowHint] = useState(false);
    const [imageLoaded, setImageLoaded] = useState(false);
    const [imageError, setImageError] = useState(false);
    
    useEffect(() => {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
        const timer = setTimeout(() => setShowHint(true), 2000);
        return () => clearTimeout(timer);
    }, []);

    // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    useEffect(() => {
        const img = new Image();
        img.onload = () => setImageLoaded(true);
        img.onerror = () => setImageError(true);
        img.src = 'https://archive.org/download/logo_20260223/logo.jpg';
    }, []);

    // –ö–ª–∏–∫ –ø–æ —ç–∫—Ä–∞–Ω—É = –ø–µ—Ä–µ—Ö–æ–¥
    const handleScreenClick = () => {
        if (showHint && onComplete) {
            onComplete();
        }
    };

    const letters = ['–Ø', ' ', '–°', '–ê', '–ú'];
    const C = darkMode ? S.dark : S.light;

    return (
        <div 
            onClick={handleScreenClick}
            style={{
                position: 'fixed',
                inset: 0,
                backgroundColor: C.bg,
                backgroundImage: imageLoaded && !imageError 
                    ? 'url(https://archive.org/download/logo_20260223/logo.jpg)' 
                    : 'none',
                backgroundSize: 'cover',
                backgroundPosition: 'center',
                display: 'flex',
                flexDirection: 'column',
                alignItems: 'center',
                justifyContent: 'center',
                zIndex: 1000,
                cursor: showHint ? 'pointer' : 'default',
            }}
        >
            {/* –ó–∞—Ç–µ–º–Ω—è—é—â–∏–π –æ–≤–µ—Ä–ª–µ–π */}
            <div style={{
                position: 'absolute',
                inset: 0,
                background: imageLoaded && !imageError
                    ? 'linear-gradient(to bottom, rgba(0,0,0,0.2), rgba(0,0,0,0.5))'
                    : 'transparent',
            }} />

            {/* –ü–ª—ã–≤—É—â–∏–µ –±—É–∫–≤—ã "–Ø –°–ê–ú" ‚Äî –º–µ–Ω–µ–µ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ */}
            <div style={{
                position: 'relative',
                zIndex: 1,
                display: 'flex',
                flexDirection: 'column',
                alignItems: 'center',
                gap: '0.3rem',
            }}>
                {letters.map((letter, i) => (
                    <span 
                        key={i}
                        style={{
                            fontSize: letter === ' ' ? '0.5rem' : '5rem',
                            fontWeight: 900,
                            color: imageLoaded && !imageError 
                                ? 'rgba(255, 255, 255, 0.6)' 
                                : S.emerald600,
                            textShadow: imageLoaded && !imageError 
                                ? '0 0 60px rgba(255,255,255,0.5), 0 0 30px rgba(255,255,255,0.3)'
                                : 'none',
                            animation: `floatLetter 3s ease-in-out infinite`,
                            animationDelay: `${i * 0.3}s`,
                            letterSpacing: '0.05em',
                        }}
                    >
                        {letter === ' ' ? '' : letter}
                    </span>
                ))}
            </div>

            {/* –ü–æ–¥—Å–∫–∞–∑–∫–∞ "–ö–æ—Å–Ω–∏—Ç–µ—Å—å —ç–∫—Ä–∞–Ω–∞ –¥–ª—è –Ω–∞—á–∞–ª–∞" */}
            {showHint && (
                <div style={{
                    position: 'absolute',
                    bottom: 'calc(env(safe-area-inset-bottom, 0px) + 4rem)',
                    zIndex: 2,
                    textAlign: 'center',
                    animation: 'fadeInUp 0.8s ease-out, pulse 2s ease-in-out infinite',
                }}>
                    <p style={{
                        color: imageLoaded && !imageError 
                            ? 'rgba(255, 255, 255, 0.9)' 
                            : C.text,
                        fontSize: '1.1rem',
                        fontWeight: 500,
                        textShadow: imageLoaded && !imageError 
                            ? '0 2px 10px rgba(0,0,0,0.5)'
                            : 'none',
                        margin: 0,
                    }}>
                        –ö–æ—Å–Ω–∏—Ç–µ—Å—å —ç–∫—Ä–∞–Ω–∞ –¥–ª—è –Ω–∞—á–∞–ª–∞
                    </p>
                    
                    {/* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–µ–ª–∫–∞ –≤–≤–µ—Ä—Ö */}
                    <div style={{
                        marginTop: '1rem',
                        animation: 'bounce 1.5s ease-in-out infinite',
                    }}>
                        <div style={{
                            width: '40px',
                            height: '40px',
                            margin: '0 auto',
                            borderLeft: '3px solid rgba(255,255,255,0.7)',
                            borderTop: '3px solid rgba(255,255,255,0.7)',
                            transform: 'rotate(45deg)',
                        }} />
                    </div>
                </div>
            )}

            {/* CSS –∞–Ω–∏–º–∞—Ü–∏–∏ */}
            <style>{`
                @keyframes floatLetter {
                    0%, 100% { 
                        transform: translateY(0) scale(1); 
                        opacity: 0.5;
                    }
                    50% { 
                        transform: translateY(-20px) scale(1.03); 
                        opacity: 0.8;
                    }
                }
                
                @keyframes fadeInUp {
                    from {
                        opacity: 0;
                        transform: translateY(20px);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }
                
                @keyframes pulse {
                    0%, 100% {
                        opacity: 1;
                    }
                    50% {
                        opacity: 0.7;
                    }
                }
                
                @keyframes bounce {
                    0%, 100% {
                        transform: translateY(0);
                    }
                    50% {
                        transform: translateY(-10px);
                    }
                }
            `}</style>
        </div>
    );
};
const AgreementScreen = ({ onAccept, darkMode }) => {
    const [isChecked, setIsChecked] = useState(false);
    const C = darkMode ? S.dark : S.light;
    return (<div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', minHeight: '100vh', padding: '1rem', backgroundColor: C.bg, color: C.text, boxSizing: 'border-box' }}> <div style={{ padding: '2rem', borderRadius: '1rem', boxShadow: '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)', width: '100%', maxWidth: '30rem', backgroundColor: C.cardBg, border: `1px solid ${C.cardBorder}` }}> <h2 style={{ fontSize: '1.5rem', fontWeight: 700, marginBottom: '1rem', textAlign: 'center' }}>–õ–∏—Ü–µ–Ω–∑–∏–æ–Ω–Ω–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</h2> <div style={{ height: '50vh', overflowY: 'auto', border: `1px solid ${C.cardBorder}`, padding: '1rem', borderRadius: '0.5rem', marginBottom: '1.5rem', fontSize: '0.875rem' }}> <p><strong>1. –û–±—â–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è</strong></p><p>1.1. –ò—Å–ø–æ–ª—å–∑—É—è –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –≤—ã –ø—Ä–∏–Ω–∏–º–∞–µ—Ç–µ —É—Å–ª–æ–≤–∏—è –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –°–æ–≥–ª–∞—à–µ–Ω–∏—è.</p> <p><strong>2. –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –∏ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</strong></p><p>2.1. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –≤–∞—à–µ–º –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –±–ª–∏–∑–æ—Å—Ç–∏ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π (–≤ —Ä–∞–¥–∏—É—Å–µ 20 –º–µ—Ç—Ä–æ–≤).</p><p>2.2. –î–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.</p><p>2.3. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö.</p> <p><strong>3. –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å</strong></p><p>3.1. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –º–∞—Ä—à—Ä—É—Ç–æ–≤.</p> </div> <div style={{ display: 'flex', alignItems: 'center', marginBottom: '1.5rem' }}> <input type="checkbox" id="agreement-checkbox" checked={isChecked} onChange={() => setIsChecked(!isChecked)} style={{ width: '1.25rem', height: '1.25rem', marginRight: '0.75rem' }} /> <label htmlFor="agreement-checkbox" style={{ fontSize: '0.875rem' }}>–Ø –ø—Ä–∏–Ω–∏–º–∞—é —É—Å–ª–æ–≤–∏—è —Å–æ–≥–ª–∞—à–µ–Ω–∏—è –∏ –ø–æ–ª–∏—Ç–∏–∫—É –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏.</label> </div> <button onClick={onAccept} disabled={!isChecked} style={{ width: '100%', backgroundColor: S.emerald600, color: 'white', fontWeight: 600, padding: '0.75rem 0', borderRadius: '0.75rem', border: 'none', cursor: 'pointer', fontSize: '1rem', opacity: isChecked ? 1 : 0.5, transition: 'opacity 0.2s' }}>–ü—Ä–∏–Ω—è—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button> </div> </div>);
};

export default function App() {
    const [phase, setPhase] = useState('loading');
    const loadFromStorage = (key, defaultValue) => { try { const saved = localStorage.getItem(key); return saved ? JSON.parse(saved) : defaultValue; } catch (error) { console.error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ localStorage –¥–ª—è –∫–ª—é—á–∞ ${key}:`, error); return defaultValue; } };

    const [favs, setFavs] = useState(() => loadFromStorage('app-favs', []));
    const [completed, setCompleted] = useState(() => loadFromStorage('app-completed', []));
    const [account, setAccount] = useState(() => loadFromStorage('app-account', { name: "–ì–æ—Å—Ç—å", level: "–ù–æ–≤–∏—á–æ–∫", rewards: [], completedRoutesCount: 0 }));
    const [darkMode, setDarkMode] = useState(() => loadFromStorage('app-darkMode', window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches));
    const [units, setUnits] = useState(() => loadFromStorage('app-units', 'km'));
    const [currentLang, setCurrentLang] = useState(() => loadFromStorage('app-lang', 'ru'));
    const [currentCity, setCurrentCity] = useState(() => loadFromStorage('app-city', 'kemerovo'));
    const [rewardModal, setRewardModal] = useState(false);
    const [rewardMsg, setRewardMsg] = useState("");
    const [showContactModal, setShowContactModal] = useState(false);

    const [showNotifPermissionModal, setShowNotifPermissionModal] = useState(false);
    const rewardTiers = [{ count: 1, title: "–ù–∞—á–∏–Ω–∞—é—â–∏–π" }, { count: 3, title: "–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å" }, { count: 5, title: "–ú–∞–≥–∏—Å—Ç—Ä" }];
    const buildInfo = { version: "2.10", date: "27.02.2026" }; 
    const routeIcons = { "–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": <Landmark style={{ color: S.orange500, width: '1.25rem', height: '1.25rem' }} />, "–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": <Leaf style={{ color: S.emerald600, width: '1.25rem', height: '1.25rem' }} />, "–°–µ–º–µ–π–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": <Heart style={{ color: S.red500, width: '1.25rem', height: '1.25rem' }} />, "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã": <Compass style={{ color: S.sky600, width: '1.25rem', height: '1.25rem' }} />, "–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": <MapPin style={{ color: '#a855f7', width: '1.25rem', height: '1.25rem' }} />, "–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": <Activity style={{ color: S.emerald700, width: '1.25rem', height: '1.25rem' }} />, "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Ä–±–∞–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã": <Monitor style={{ color: S.dark.textMuted, width: '1.25rem', height: '1.25rem' }} /> };

    useEffect(() => { localStorage.setItem('app-favs', JSON.stringify(favs)); }, [favs]);
    useEffect(() => { localStorage.setItem('app-completed', JSON.stringify(completed)); }, [completed]);
    useEffect(() => { localStorage.setItem('app-account', JSON.stringify(account)); }, [account]);
    useEffect(() => { localStorage.setItem('app-darkMode', JSON.stringify(darkMode)); }, [darkMode]);
    useEffect(() => { localStorage.setItem('app-units', JSON.stringify(units)); }, [units]);
    useEffect(() => { localStorage.setItem('app-lang', JSON.stringify(currentLang)); }, [currentLang]);
    useEffect(() => { localStorage.setItem('app-city', JSON.stringify(currentCity)); }, [currentCity]);


useEffect(() => {
    const checkNotifPermissions = async () => {
        try {
            const result = await LocalNotifications.checkPermissions();
            if (result.display === 'granted') return;
            
            const lastAsked = parseInt(localStorage.getItem('notifPermissionAskedAt') || '0');
            const dayInMs = 24 * 60 * 60 * 1000;
            const now = Date.now();
            
            if (now - lastAsked < dayInMs) return;
            
            setTimeout(() => {
                setShowNotifPermissionModal(true);
            }, 3000);
        } catch (e) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π:', e);
        }
    };
    
    if (phase === 'mainApp') {
        checkNotifPermissions();
    }
}, [phase]);

    useEffect(() => { const C = darkMode ? S.dark : S.light; document.body.style.backgroundColor = C.bg; const styleTag = document.createElement('style'); styleTag.innerHTML = `html, body { margin: 0; padding: 0; width: 100%; height: 100%; overflow-x: hidden; box-sizing: border-box; }`; document.head.appendChild(styleTag); return () => { document.head.removeChild(styleTag); document.body.style.backgroundColor = ''; }; }, [darkMode]);

    



const handleAcceptAgreement = () => { 
    localStorage.setItem('agreementAccepted', JSON.stringify(true)); 
    setPhase('mainApp'); 
};
    const handleExitApp = () => { CapacitorApp.exitApp(); };

    const handleAllowNotifications = async () => {
    setShowNotifPermissionModal(false);
    try {
        const result = await LocalNotifications.requestPermissions();
        if (result.display === 'granted') {
            alert('–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã! üéâ');
        }
    } catch (e) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π:', e);
    }
};

const handleLaterNotifications = () => {
    setShowNotifPermissionModal(false);
    localStorage.setItem('notifPermissionAskedAt', Date.now().toString());
};

    const handleComplete = useCallback((route) => { if (completed.some(c => c.name === route.name)) { alert("–≠—Ç–æ—Ç –º–∞—Ä—à—Ä—É—Ç —É–∂–µ –æ—Ç–º–µ—á–µ–Ω –∫–∞–∫ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–π."); return; } const date = new Date(); const newCompleted = [...completed, { ...route, date: date.toLocaleDateString('ru-RU'), isoDate: date.toISOString() }]; setCompleted(newCompleted); const newCount = newCompleted.length; setAccount(prevAccount => { const newAccountState = { ...prevAccount, completedRoutesCount: newCount }; const tier = rewardTiers.find(t => t.count === newCount); if (tier && !prevAccount.rewards.includes(tier.title)) { newAccountState.level = tier.title; newAccountState.rewards.push(tier.title); setRewardMsg(`–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –ø–æ–ª—É—á–∏–ª–∏ –Ω–æ–≤–æ–µ –∑–≤–∞–Ω–∏–µ: ¬´${tier.title}¬ª!`); setRewardModal(true); } return newAccountState; }); }, [completed, rewardTiers]);
    const isFav = useCallback((route) => favs.some(f => f.name === route.name && (f.cityId === currentCity || (!f.cityId && currentCity === 'kemerovo'))), [favs, currentCity]);
    const toggleFavorite = useCallback((route) => { setFavs(prev => { const isCurrentlyFav = prev.some(f => f.name === route.name && (f.cityId === currentCity || (!f.cityId && currentCity === 'kemerovo'))); if (isCurrentlyFav) { return prev.filter(f => !(f.name === route.name && (f.cityId === currentCity || (!f.cityId && currentCity === 'kemerovo')))); } else { return [...prev, { ...route, cityId: currentCity }]; } }); }, [currentCity]);

    const appRootStyle = { minHeight: '100vh', width: '100%', backgroundColor: darkMode ? S.dark.bg : S.light.bg, boxSizing: 'border-box' };
const handleLoadingComplete = () => {
    const hasAccepted = loadFromStorage('agreementAccepted', false);
    if (!hasAccepted) {
        setPhase('agreement');
    } else {
        setPhase('mainApp');
    }
};
// –ê–≤—Ç–æ–ø–µ—Ä–µ—Ö–æ–¥ —á–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥—ã (—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ –¥–ª—è Android)

    const renderContent = () => {
    switch (phase) {
        case 'loading': 
            return <LoadingScreen darkMode={darkMode} onComplete={handleLoadingComplete} />;
        case 'agreement': 
            return <AgreementScreen onAccept={handleAcceptAgreement} darkMode={darkMode} />;
        case 'mainApp': 
            return (
                <MainRouteApp 
                    onExit={handleExitApp} 
                    favoriteRoutes={favs} 
                    completedRoutes={completed} 
                    handleRouteCompletionGlobal={handleComplete} 
                    isRouteInFavorites={isFav} 
                    toggleFavorite={toggleFavorite} 
                    account={account} 
                    darkMode={darkMode} 
                    setDarkMode={setDarkMode} 
                    units={units} 
                    setUnits={setUnits} 
                    routeIcons={routeIcons} 
                    buildInfo={buildInfo} 
                    setShowContactModal={setShowContactModal} 
                    setAccount={setAccount} 
                    currentLang={currentLang} 
                    setCurrentLang={setCurrentLang} 
                    currentCity={currentCity} 
                    setCurrentCity={setCurrentCity} 
                />
            );
        default:
            return <LoadingScreen darkMode={darkMode} onComplete={handleLoadingComplete} />;
    }
};

    return (
    <div style={appRootStyle}>
        {renderContent()}
        <Modal show={rewardModal} message={rewardMsg} onClose={() => setRewardModal(false)} darkMode={darkMode} buttonText="–û—Ç–ª–∏—á–Ω–æ!" lang={currentLang} />
        <ContactModal show={showContactModal} onClose={() => setShowContactModal(false)} darkMode={darkMode} lang={currentLang} />
        
        {/* –ú–æ–¥–∞–ª–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */}
        <NotificationPermissionModal 
            show={showNotifPermissionModal} 
            onAllow={handleAllowNotifications} 
            onLater={handleLaterNotifications} 
            darkMode={darkMode} 
            lang={currentLang} 
        />
    </div>
);
}